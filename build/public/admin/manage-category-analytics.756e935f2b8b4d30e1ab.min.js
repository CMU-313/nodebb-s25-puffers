"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[83436,99127,34271,69185,86198,1091,49897],{13118:(w,m,i)=>{i.r(m),i.d(m,{init:()=>E});var l=i(92262),y=i(65348),b=i.n(y);l.t1.register(l.ZT,l.PP,l.kc,l.No,l.FN,l.m_,l.dN);function E(){y.init($('[component="category-selector"]'),{onSelect:function(e){ajaxify.go("admin/manage/categories/"+e.cid+"/analytics")},showLinks:!0,template:"admin/partials/category/selector-dropdown-right"});const p=document.getElementById("pageviews:hourly"),f=document.getElementById("pageviews:daily"),s=document.getElementById("topics:daily"),t=document.getElementById("posts:daily"),o=utils.getHoursArray().map(function(e,r){return r%3?"":e}),d=utils.getDaysArray().map(function(e,r){return r%3?"":e});utils.isMobile()&&(l.t1.defaults.plugins.tooltip.enabled=!1);const a={label:"",fill:!0,tension:.25,pointHoverBackgroundColor:"#fff",pointBorderColor:"#fff"},g={"pageviews:hourly":{labels:o,datasets:[{...a,backgroundColor:"rgba(186,139,175,0.2)",borderColor:"rgba(186,139,175,1)",pointBackgroundColor:"rgba(186,139,175,1)",pointHoverBorderColor:"rgba(186,139,175,1)",data:ajaxify.data.analytics["pageviews:hourly"]}]},"pageviews:daily":{labels:d,datasets:[{...a,backgroundColor:"rgba(151,187,205,0.2)",borderColor:"rgba(151,187,205,1)",pointBackgroundColor:"rgba(151,187,205,1)",pointHoverBorderColor:"rgba(151,187,205,1)",data:ajaxify.data.analytics["pageviews:daily"]}]},"topics:daily":{labels:d.slice(-7),datasets:[{...a,backgroundColor:"rgba(171,70,66,0.2)",borderColor:"rgba(171,70,66,1)",pointBackgroundColor:"rgba(171,70,66,1)",pointHoverBorderColor:"rgba(171,70,66,1)",data:ajaxify.data.analytics["topics:daily"]}]},"posts:daily":{labels:d.slice(-7),datasets:[{...a,backgroundColor:"rgba(161,181,108,0.2)",borderColor:"rgba(161,181,108,1)",pointBackgroundColor:"rgba(161,181,108,1)",pointHoverBorderColor:"rgba(161,181,108,1)",data:ajaxify.data.analytics["posts:daily"]}]}};p.width=$(p).parent().width(),f.width=$(f).parent().width(),s.width=$(s).parent().width(),t.width=$(t).parent().width();const c={responsive:!0,animation:!1,scales:{y:{beginAtZero:!0}}};new l.t1(p.getContext("2d"),{type:"line",data:g["pageviews:hourly"],options:c}),new l.t1(f.getContext("2d"),{type:"line",data:g["pageviews:daily"],options:c}),new l.t1(s.getContext("2d"),{type:"line",data:g["topics:daily"],options:c}),new l.t1(t.getContext("2d"),{type:"line",data:g["posts:daily"],options:c})}},49897:(w,m,i)=>{i.r(m),i.d(m,{del:()=>c,get:()=>t,head:()=>o,patch:()=>a,post:()=>d,put:()=>g});var l=i(91749),y=i.n(l),b=i(40027),E=i.n(b);const p=config.relative_path+"/api/v3";async function f(e,r){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:p+e.url,typeof r=="function"){s(e).then(n=>r(null,n),n=>r(n));return}try{return await s(e)}catch(n){if(n.message==="A valid login session was not found. Please log in and try again."){const{url:u}=await(0,l.fire)("filter:admin.reauth",{url:"login"});return(0,b.confirm)("[[error:api.reauth-required]]",C=>{C&&ajaxify.go(u)})}throw n}}async function s(e){const{url:r}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,l.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const n=await fetch(r,e),{headers:u}=n,C=u.get("content-type"),v=C&&C.startsWith("application/json");let h;if(e.method!=="HEAD"&&(v?h=await n.json():h=await n.text()),!n.ok)throw h?new Error(v?h.status.message:h):new Error(n.statusText);return v&&h&&h.hasOwnProperty("status")&&h.hasOwnProperty("response")?h.response:h}function t(e,r,n){return f({url:e+(r&&Object.keys(r).length?"?"+$.param(r):"")},n)}function o(e,r,n){return f({url:e+(r&&Object.keys(r).length?"?"+$.param(r):""),method:"HEAD"},n)}function d(e,r,n){return f({url:e,method:"POST",data:r,headers:{"x-csrf-token":config.csrf_token}},n)}function a(e,r,n){return f({url:e,method:"PATCH",data:r,headers:{"x-csrf-token":config.csrf_token}},n)}function g(e,r,n){return f({url:e,method:"PUT",data:r,headers:{"x-csrf-token":config.csrf_token}},n)}function c(e,r,n){return f({url:e,method:"DELETE",data:r,headers:{"x-csrf-token":config.csrf_token}},n)}},96349:(w,m,i)=>{var l,y;l=[i(29930),i(89336),i(49897)],y=function(b,E,p){const f={};return f.init=function(s,t){let o=null;t=t||{},t.privilege=t.privilege||"topics:read",t.states=t.states||["watching","tracking","notwatching","ignoring"],t.cacheList=t.hasOwnProperty("cacheList")?t.cacheList:!0;let d=[];Array.isArray(t.localCategories)&&(d=t.localCategories.map(r=>({...r}))),t.selectedCids=t.selectedCids||ajaxify.data.selectedCids||[];const a=s.find('[component="category-selector-search"]');if(!a.length)return;const g=a.parent('[component="category/dropdown"]').length>0||a.parent('[component="category-selector"]').length>0;s.on("show.bs.dropdown",function(){g&&(s.find(".dropdown-toggle").css({visibility:"hidden"}),a.removeClass("hidden"),a.css({"z-index":s.find(".dropdown-toggle").css("z-index")+1}));function r(){const n=a.find("input").val();n.length>1||!n&&!o?c(n,function(u){o=t.cacheList&&(o||u),e(u)}):!n&&o&&e(o)}a.on("click",function(n){n.preventDefault(),n.stopPropagation()}),a.find("input").val("").on("keyup",utils.debounce(r,300)),r()}),s.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||a.find("input").focus()}),s.on("hide.bs.dropdown",function(){g&&(s.find(".dropdown-toggle").css({visibility:"inherit"}),a.addClass("hidden")),a.off("click"),a.find("input").off("keyup")});function c(r,n){p.get("/search/categories",{search:r,query:utils.params(),parentCid:t.parentCid||0,selectedCids:t.selectedCids,privilege:t.privilege,states:t.states,showLinks:t.showLinks},function(u,{categories:C}){if(u)return b.error(u);n(d.concat(C))})}function e(r){const n=t.selectedCids.map(String);r.forEach(function(u){u.selected=n.includes(String(u.cid))}),app.parseAndTranslate(t.template,{categoryItems:r.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(u){s.find('[component="category/list"]').html(u.find('[component="category/list"]').html()),s.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!r.length);const C=E.Dropdown.getInstance(s.find(".dropdown-toggle").get(0));C&&C.update()})}},f}.apply(m,l),y!==void 0&&(w.exports=y)},65348:(w,m,i)=>{var l,y;l=[i(96349),i(40027),i(91749),i(17459)],y=function(b,E,p,f){const s={};return s.init=function(t,o){if(!t||!t.length)return;o=o||{};const d=o.onSelect||function(){};o.states=o.states||["watching","tracking","notwatching","ignoring"],o.template=o.template||"partials/category/selector-dropdown-left",p.fire("action:category.selector.options",{el:t,options:o}),b.init(t,o);const a={el:t,selectedCategory:null};t.on("click","[data-cid]",function(){const c=$(this);return c.hasClass("disabled")?!1:(a.selectCategory(c.attr("data-cid")),d(a.selectedCategory))});let g=a.el.find('[component="category-selector-selected"]').html();return f.translate(g,c=>{g=c}),a.selectCategory=function(c){const e=a.el.find('[data-cid="'+c+'"]');a.selectedCategory={cid:c,name:e.attr("data-name")},e.length?a.el.find('[component="category-selector-selected"]').html(e.find('[component="category-markup"]').html()):a.el.find('[component="category-selector-selected"]').html(g)},a.getSelectedCategory=function(){return a.selectedCategory},a.getSelectedCid=function(){return a.selectedCategory?a.selectedCategory.cid:0},o.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(o.template,{selectedCategory:o.selectedCategory},function(c){a.el.find('[component="category-selector-selected"]').html(c.find('[component="category-selector-selected"]').html())}),a},s.modal=function(t){t=t||{},t.onSelect=t.onSelect||function(){},t.onSubmit=t.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:t.message},function(o){const d=E.dialog({title:t.title||"[[modules:composer.select-category]]",message:o,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:g}}}),a=s.init(d.find('[component="category-selector"]'),t);function g(c){return c.preventDefault(),a.selectedCategory&&(t.onSubmit(a.selectedCategory),d.modal("hide")),!1}t.openOnLoad&&d.on("shown.bs.modal",function(){d.find(".dropdown-toggle").dropdown("toggle")}),d.find("form").on("submit",g)})},s}.apply(m,l),y!==void 0&&(w.exports=y)}}]);
