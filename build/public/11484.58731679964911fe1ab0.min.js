(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[11484,6232,18732,87212,33069,98463],{449:(b,E,c)=>{b.exports=c(91943)},89596:(b,E,c)=>{b.exports=c(62590)},99594:(b,E,c)=>{b.exports=c(57904)},68636:(b,E,c)=>{"use strict";var h;h=function(){function p(){this._store={},this._keys=[]}p.prototype.isMock=!0,p.prototype.setItem=function(e,s){e=String(e),this._keys.indexOf(e)===-1&&this._keys.push(e),this._store[e]=s},p.prototype.getItem=function(e){return e=String(e),this._keys.indexOf(e)===-1?null:this._store[e]},p.prototype.removeItem=function(e){e=String(e),this._keys=this._keys.filter(function(s){return s!==e}),this._store[e]=null},p.prototype.clear=function(){this._keys=[],this._store={}},p.prototype.key=function(e){return e=parseInt(e,10)||0,this._keys[e]},Object.defineProperty&&Object.defineProperty(p.prototype,"length",{get:function(){return this._keys.length}});let g;const r=Date.now().toString();try{if(g=window.localStorage,g.setItem(r,r),g.getItem(r)!==r)throw Error("localStorage behaved unexpectedly");return g.removeItem(r),g}catch(e){console.warn(e),console.warn("localStorage failed, falling back on sessionStorage");try{if(g=window.sessionStorage,g.setItem(r,r),g.getItem(r)!==r)throw Error("sessionStorage behaved unexpectedly");return g.removeItem(r),g}catch(s){return console.warn(s),console.warn("sessionStorage failed, falling back on memory storage"),new p}}}.call(E,c,E,b),h!==void 0&&(b.exports=h)},14063:(b,E,c)=>{"use strict";b=c.nmd(b);var h,p;h=[c(17459),c(91749)],p=function(g,r){const e={};let s=!1;e.init=function(){if(e.taskbar=$('[component="taskbar"]'),e.tasklist=e.taskbar.find("ul"),!e.taskbar.length||!e.tasklist.length){s=!0;return}e.taskbar.on("click","li",async function(){const t=$(this),n=t.attr("data-module"),i=t.attr("data-uuid"),l=await app.require(n);return t.hasClass("active")?l.minimize(i):(o(),l.load(i),e.toggleNew(i,!1),e.tasklist.removeClass("active"),t.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){e.closeAll()})},e.close=async function(t,n){if(s)return;if(e.tasklist.find('[data-module="'+b+'"][data-uuid="'+n+'"]').length){const l=await app.require(t);l&&typeof l.close=="function"&&l.close(n)}},e.closeAll=function(t){if(s)return;let n="[data-uuid]";t&&(n='[data-module="'+t+'"]'+n),e.tasklist.find(n).each(function(i,l){e.close(t||l.getAttribute("data-module"),l.getAttribute("data-uuid"))})},e.discard=function(t,n){if(s)return;e.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]').remove(),m()},e.push=function(t,n,i,l){if(l=l||function(){},s)return l();const u=e.tasklist.find('li[data-uuid="'+n+'"]'),f={module:t,uuid:n,options:i,element:u};r.fire("filter:taskbar.push",f),!u.length&&f.module?a(f,l):l(u)},e.get=function(t){return s?[]:$('[data-module="'+t+'"]').map(function(i,l){return $(l).data()})},e.minimize=function(t,n){if(s)return;e.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]').toggleClass("active",!1)},e.toggleNew=function(t,n,i){if(s)return;e.tasklist.find('[data-uuid="'+t+'"]').toggleClass("new",n),i||r.fire("action:taskbar.toggleNew",t)},e.updateActive=function(t){if(s)return;const n=e.tasklist.find("li");n.removeClass("active"),n.filter('[data-uuid="'+t+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+t+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},e.isActive=function(t){return s?!1:e.tasklist.find('li[data-uuid="'+t+'"]').hasClass("active")};function m(){if(s)return;e.tasklist.find("li").length>0?e.taskbar.attr("data-active","1"):e.taskbar.removeAttr("data-active")}function o(){s||e.tasklist.find(".active").removeClass("active")}function a(t,n){if(s)return n();g.translate(t.options.title,function(i){const l=$("<div></div>").text(i||"NodeBB Task").html(),u=$("<li></li>").addClass(t.options.className).html('<a href="#"'+(t.options.image?` style="background-image: url('`+t.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(t.options.icon?'<i class="fa '+t.options.icon+'"></i> ':"")+'<span aria-label="'+l+'" component="taskbar/title">'+l+"</span></a>").attr({title:l,"data-module":t.module,"data-uuid":t.uuid}).addClass(t.options.state!==void 0?t.options.state:"active");(!t.options.state||t.options.state==="active")&&o(),e.tasklist.append(u),m(),t.element=u,u.data(t),r.fire("action:taskbar.pushed",t),n(u)})}const d=function(t,n,i){switch(n){case"title":t.find('[component="taskbar/title"]').text(i);break;case"icon":t.find("i").attr("class","fa fa-"+i);break;case"image":t.find("a").css("background-image",i?'url("'+i.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":t.find("a").css("background-color",i);break;case"color":t.find("a").css("color",i);break}};return e.update=function(t,n,i){if(s)return;const l=e.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]');if(!l.length)return;const u=l.data();Object.keys(i).forEach(function(f){u[f]=i[f],d(l,f,i[f])}),l.data(u)},e}.apply(E,h),p!==void 0&&(b.exports=p)},36159:(b,E,c)=>{"use strict";var h,p;h=[c(49897),c(40027),c(29930),c(24187),c(81335),c(17459),c(65285)],p=function(g,r,e,s,m,o){const a={};return a.get=d=>g.get(`/topics/${d}/thumbs`,{}),a.getByPid=d=>g.get(`/posts/${d}`,{}).then(t=>a.get(t.tid)),a.delete=(d,t)=>g.del(`/topics/${d}/thumbs`,{path:t}),a.deleteAll=d=>{a.get(d).then(t=>{Promise.all(t.map(n=>a.delete(d,n.url)))})},a.upload=d=>new Promise(t=>{s.show({title:"[[topic:composer.thumb-title]]",method:"put",route:config.relative_path+`/api/v3/topics/${d}/thumbs`},function(n){t(n)})}),a.modal={},a.modal.open=function(d){const{id:t,pid:n}=d;let{modal:i}=d,l;return new Promise(u=>{Promise.all([a.get(t),n?a.getByPid(n):[]]).then(f=>new Promise(w=>{const F=f.reduce((D,v)=>D.concat(v));l=F.length,w(F)})).then(f=>m.render("modals/topic-thumbs",{thumbs:f})).then(f=>{i?o.translate(f,function(w){i.find(".bootbox-body").html(w),a.modal.handleSort({modal:i,numThumbs:l})}):(i=r.dialog({title:"[[modules:thumbs.modal.title]]",message:f,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(a.upload(t).then(()=>{a.modal.open({...d,modal:i}),Promise.all([c.e(54516),c.e(99166),c.e(47061),c.e(49775)]).then(function(){var w=[c(71431)];(F=>{F.updateThumbCount(t,$(`[component="composer"][data-uuid="${t}"]`)),u()}).apply(null,w)}).catch(c.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),a.modal.handleDelete({...d,modal:i}),a.modal.handleSort({modal:i,numThumbs:l}))})})},a.modal.handleDelete=d=>{const t=d.modal.get(0),{id:n}=d;t.addEventListener("click",i=>{i.target.closest('button[data-action="remove"]')&&r.confirm("[[modules:thumbs.modal.confirm-remove]]",l=>{if(!l)return;const u=i.target.closest("[data-id]").getAttribute("data-id"),f=i.target.closest("[data-path]").getAttribute("data-path");g.del(`/topics/${u}/thumbs`,{path:f}).then(()=>{a.modal.open(d),Promise.all([c.e(54516),c.e(99166),c.e(47061),c.e(49775)]).then(function(){var w=[c(71431)];(F=>{F.updateThumbCount(n,$(`[component="composer"][data-uuid="${n}"]`))}).apply(null,w)}).catch(c.oe)}).catch(e.error)})})},a.modal.handleSort=({modal:d,numThumbs:t})=>{if(t>1){const n=d.find(".topic-thumbs-modal");n.sortable({items:"[data-id]"}),n.on("sortupdate",a.modal.handleSortChange)}},a.modal.handleSortChange=(d,t)=>{const n=t.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(n).forEach((i,l)=>{const u=i.getAttribute("data-id");let f=i.getAttribute("data-path");f=f.replace(new RegExp(`^${config.upload_url}`),""),g.put(`/topics/${u}/thumbs/order`,{path:f,order:l}).catch(e.error)})},a}.apply(E,h),p!==void 0&&(b.exports=p)},24187:(b,E,c)=>{"use strict";var h,p;h=[c(64061)],p=function(){const g={};g.show=function(o,a){const d=o.hasOwnProperty("fileSize")&&o.fileSize!==void 0?parseInt(o.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:o.hasOwnProperty("showHelp")&&o.showHelp!==void 0?o.showHelp:!0,fileSize:d,title:o.title||"[[global:upload-file]]",description:o.description||"",button:o.button||"[[global:upload]]",accept:o.accept?o.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show"),t.on("hidden.bs.modal",function(){t.remove()});const n=t.find("#uploadForm");n.attr("action",o.route),n.find("#params").val(JSON.stringify(o.params)),t.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),n.submit()}),n.submit(function(){return r(t,d,a),!1})})},g.hideAlerts=function(o){$(o).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function r(o,a,d){e(o,"status","[[uploads:uploading-file]]"),o.find("#upload-progress-bar").css("width","0%"),o.find("#upload-progress-box").show().removeClass("hide");const t=o.find("#fileInput");if(!t.val())return e(o,"error","[[uploads:select-file-to-upload]]");if(!m(t[0],a))return e(o,"error","[[error:file-too-big, "+a+"]]");g.ajaxSubmit(o,d)}function e(o,a,d){g.hideAlerts(o),a==="error"&&o.find("#fileUploadSubmitBtn").removeClass("disabled"),d=d.replace(/&amp;#44/g,"&#44"),o.find("#alert-"+a).translateText(d).removeClass("hide")}g.ajaxSubmit=function(o,a){o.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(t){t=s(t),e(o,"error",t.responseJSON?.status?.message||t.responseJSON?.error||`[[error:upload-error-fallback, ${t.status} ${t.statusText}]]`)},uploadProgress:function(t,n,i,l){o.find("#upload-progress-bar").css("width",l+"%")},success:function(t){let n=s(t);t.hasOwnProperty("response")&&t.hasOwnProperty("status")&&t.status.code==="ok"&&(n=t.response.images),a(n[0].url),e(o,"success","[[uploads:upload-success]]"),setTimeout(function(){g.hideAlerts(o),o.modal("hide")},750)}})};function s(o){if(typeof o=="string")try{return JSON.parse(o)}catch{return{error:"[[error:parse-error]]"}}return o}function m(o,a){return window.FileReader&&a?o.files[0].size<=a*1e3:!0}return g}.apply(E,h),p!==void 0&&(b.exports=p)},91943:(b,E,c)=>{"use strict";var h,p;h=[c(89596),c(99594),c(36159),c(51916)],p=function(g,r,e,s){var m={},o={picture:function(){var n=this;n.find("#files").attr("accept","image/*").click()},upload:function(){var n=this;n.find("#files").attr("accept","").click()},thumbs:function(){m.exitFullscreen();var n=this;Promise.all([c.e(54516),c.e(99166),c.e(47061),c.e(29567)]).then(function(){var i=[c(71431)];(function(l){const u=n.get(0).getAttribute("data-uuid"),f=l.posts[u];(f.action==="topics.post"||f.action==="posts.edit"&&f.isMain)&&e.modal.open({id:u,pid:f.pid}).then(()=>{n.trigger("thumb.uploaded"),l.updateThumbCount(u,n)})}).apply(null,i)}).catch(c.oe)},tags:function(){var n=this;n.find(".tags-container").toggleClass("hidden")},zen:function(){var n=this;$(window).one("resize",function(){function i(){s.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),r.reposition(n),$(window).off("resize",i))}s.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),n.find(".write").focus(),$(window).on("resize",i),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",s.exit))}),s.toggle(n.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:n})}},a=[];m.exitFullscreen=function(){s.isEnabled&&s.isFullscreen&&s.exit()},m.addComposerButtons=function(){const n=$(".formatting-bar"),i=n.find(".formatting-group #fileForm");a.forEach(u=>{let f="";Array.isArray(u.dropdownItems)&&u.dropdownItems.length?f=t(u):f=`
					<li title="${u.title||""}">
						<button data-format="${u.name}" class="btn btn-sm btn-link text-reset position-relative" aria-label="${u.title||""}">
							<i class="${u.iconClass}"></i>
							${d(u)}
						</button>
					</li>
				`,i.before(f)}),n.find(".formatting-group>li").tooltip({container:"#content",animation:!1,trigger:"manual"}).on("mouseenter",function(u){const f=$(u.target);f.hasClass("dropdown-menu")||!!f.parents(".dropdown-menu").length||$(this).tooltip("show")}).on("click mouseleave",function(){$(this).tooltip("hide")})};function d(n){let i="";return n.badge&&(i='<span class="px-1 position-absolute top-0 start-100 translate-middle badge rounded text-bg-info"></span>'),i}function t(n){const i=n.dropdownItems.map(function(l){return`
				<li>
					<a href="#" data-format="${l.name}" class="dropdown-item rounded-1 position-relative" role="menuitem">
						<i class="${l.iconClass} text-secondary"></i> ${l.text}
						${d(l)}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1" title="${n.title}">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="${n.title}">
					<i class="${n.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1" role="menu">
				${i}
				</ul>
			</li>
		`}return m.addButton=function(n,i,l,u){u=u||n.replace("fa fa-",""),o[u]=i,a.push({name:u,iconClass:n,title:l})},m.addDropdown=function(n){a.push({iconClass:n.iconClass,title:n.title,dropdownItems:n.dropdownItems}),n.dropdownItems.forEach(i=>{i.name&&i.onClick&&(o[i.name]=i.onClick)})},m.getDispatchTable=function(){return o},m.addButtonDispatch=function(n,i){o[n]=i},m.addHandler=function(n){n.on("click",".formatting-bar [data-format]",function(i){var l=$(this).attr("data-format"),u=$(this).parents('[component="composer"]').find("textarea")[0];o.hasOwnProperty(l)&&(o[l].call(n,u,u.selectionStart,u.selectionEnd,i),g.render(n))})},m}.apply(E,h),p!==void 0&&(b.exports=p)},62590:(b,E,c)=>{"use strict";var h,p;h=[c(91749)],p=function(g){var r={};return r.render=function(e,s){if(s=s||function(){},!e.find(".preview-container").is(":visible"))return s();var m=e.find("textarea");socket.emit("plugins.composer.renderPreview",m.val(),function(o,a){o||(a=$("<div>"+a+"</div>"),a.find("img:not(.not-responsive)").addClass("img-fluid"),e.find(".preview").html(a),g.fire("action:composer.preview",{postContainer:e,preview:a}),s())})},r.matchScroll=function(e){if(e.find(".preview-container").is(":visible")){var s=e.find("textarea"),m=e.find(".preview");if(s.length&&m.length){var o=s[0].scrollHeight-s.height();if(o===0)return;var a=s.scrollTop()/o;m.scrollTop(Math.max(m[0].scrollHeight-m.height(),0)*a)}}},r.handleToggler=function(e){const s=e.get(0);r.env=utils.findBootstrapEnvironment();const m=["xs","sm"].includes(r.env),o=s.querySelector('.formatting-bar [data-action="preview"]'),a=o.querySelector(".show-text"),d=o.querySelector(".hide-text"),t=localStorage.getItem("composer:previewToggled"),n=config["composer-default"].hidePreviewOnOpen==="on";let i=!m&&(t===null&&!n||t==="true");const l=s.querySelector(".preview-container"),u=s.querySelector(".write-container");if(!o)return;function f(w){m?(l.classList.toggle("hide",!1),u.classList.toggle("maximized",!1),l.classList.toggle("d-none",!w),l.classList.toggle("d-flex",w),l.classList.toggle("w-100",w),u.classList.toggle("d-flex",!w),u.classList.toggle("d-none",w),u.classList.toggle("w-100",!w)):(l.classList.toggle("hide",!w),u.classList.toggle("w-50",w),u.classList.toggle("w-100",!w),localStorage.setItem("composer:previewToggled",w)),a.classList.toggle("hide",w),d.classList.toggle("hide",!w),w&&r.render(e),r.matchScroll(e)}r.toggle=f,o.addEventListener("click",w=>{w.button===0&&(i=!i,f(i))}),f(i)},r}.apply(E,h),p!==void 0&&(b.exports=p)},57904:(b,E,c)=>{"use strict";var h,p;h=[c(14063)],p=function(g){var r={},e=0,s=.3,m=.05,o=768,a=$("body"),d=$(window),t=$('[component="navbar"]');const n=document.getElementById("content");var i=t[0];function l(){return localStorage.getItem("composer:resizeRatio")||.5}function u(v){localStorage.setItem("composer:resizeRatio",Math.min(v,1))}function f(){var v;i?v=i.getBoundingClientRect():v={bottom:0};var A=Math.max(v.bottom,0),x={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return x.width=x.right,x.height=x.bottom,x.boundedTop=A,x.boundedHeight=x.bottom-A,x}function w(v,A){var x=f(),C=v[0],I=window.getComputedStyle(C),N=parseInt(I.getPropertyValue("min-height"),10),B=Math.max(N/window.innerHeight,s);if(x.width>=o){const T=(x.height-x.boundedHeight)/x.height;A=Math.min(Math.max(A,B+T),1);var P=A*x.boundedHeight/x.height;C.style.top=((1-P)*100).toString()+"%";var z=C.getBoundingClientRect();n.style.paddingBottom=(z.bottom-z.top).toString()+"px"}else C.style.top=0,n.style.paddingBottom=0;v.ratio=A,g.updateActive(v.attr("data-uuid"))}var F=w,D=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return D&&(F=function(v,A){D(function(){w(v,A),setTimeout(function(){d.trigger("action:composer.resize"),v.trigger("action:composer.resize")},0)})}),r.reposition=function(v){var A=l();A>=1-m&&(A=1,v.addClass("maximized")),F(v,A)},r.maximize=function(v,A){A?F(v,1):r.reposition(v)},r.handleResize=function(v){var A=0,x=0,C=0,I=v.find(".resizer"),N=I[0];function B(S){var k=N.getBoundingClientRect(),y=(k.top+k.bottom)/2;A=(y-S.clientY)/2,x=S.clientY,d.on("mousemove",P),d.on("mouseup",z),a.on("touchmove",T)}function P(S){var k=S.clientY-A,y=f(),R=(y.height-k)/y.boundedHeight;F(v,R)}function z(S){S.preventDefault(),C=S.clientY,v.find("textarea").focus(),d.off("mousemove",P),d.off("mouseup",z),a.off("touchmove",T);var k=C-A,y=f(),R=(y.height-k)/y.boundedHeight;C-x===0&&v.hasClass("maximized")?(v.removeClass("maximized"),R=!e||e>=1-m?.5:e,F(v,R)):C-x===0||R>=1-m?(F(v,1),v.addClass("maximized"),e=R):v.removeClass("maximized"),u(R)}function T(S){S.preventDefault(),P(S.touches[0])}I.on("mousedown",function(S){S.button===0&&(S.preventDefault(),B(S))}).on("touchstart",function(S){S.preventDefault(),B(S.touches[0])}).on("touchend",z)},r}.apply(E,h),p!==void 0&&(b.exports=p)},51916:b=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var E=typeof window<"u"&&typeof window.document<"u"?window.document:{},c=b.exports,h=function(){for(var r,e=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],s=0,m=e.length,o={};s<m;s++)if(r=e[s],r&&r[1]in E){for(s=0;s<r.length;s++)o[e[0][s]]=r[s];return o}return!1}(),p={change:h.fullscreenchange,error:h.fullscreenerror},g={request:function(r,e){return new Promise(function(s,m){var o=function(){this.off("change",o),s()}.bind(this);this.on("change",o),r=r||E.documentElement;var a=r[h.requestFullscreen](e);a instanceof Promise&&a.then(o).catch(m)}.bind(this))},exit:function(){return new Promise(function(r,e){if(!this.isFullscreen){r();return}var s=function(){this.off("change",s),r()}.bind(this);this.on("change",s);var m=E[h.exitFullscreen]();m instanceof Promise&&m.then(s).catch(e)}.bind(this))},toggle:function(r,e){return this.isFullscreen?this.exit():this.request(r,e)},onchange:function(r){this.on("change",r)},onerror:function(r){this.on("error",r)},on:function(r,e){var s=p[r];s&&E.addEventListener(s,e,!1)},off:function(r,e){var s=p[r];s&&E.removeEventListener(s,e,!1)},raw:h};if(!h){c?b.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(g,{isFullscreen:{get:function(){return!!E[h.fullscreenElement]}},element:{enumerable:!0,get:function(){return E[h.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!E[h.fullscreenEnabled]}}}),c?b.exports=g:window.screenfull=g})()}}]);
