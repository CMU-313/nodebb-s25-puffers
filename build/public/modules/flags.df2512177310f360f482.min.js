"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[47282,99127,34271,1091,49897,6574],{49897:(D,E,o)=>{o.r(E),o.d(E,{del:()=>r,get:()=>a,head:()=>f,patch:()=>y,post:()=>i,put:()=>A});var d=o(91749),p=o.n(d),c=o(40027),P=o.n(c);const v=config.relative_path+"/api/v3";async function s(t,n){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:v+t.url,typeof n=="function"){u(t).then(e=>n(null,e),e=>n(e));return}try{return await u(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again."){const{url:h}=await(0,d.fire)("filter:admin.reauth",{url:"login"});return(0,c.confirm)("[[error:api.reauth-required]]",g=>{g&&ajaxify.go(h)})}throw e}}async function u(t){const{url:n}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,d.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(n,t),{headers:h}=e,g=h.get("content-type"),m=g&&g.startsWith("application/json");let l;if(t.method!=="HEAD"&&(m?l=await e.json():l=await e.text()),!e.ok)throw l?new Error(m?l.status.message:l):new Error(e.statusText);return m&&l&&l.hasOwnProperty("status")&&l.hasOwnProperty("response")?l.response:l}function a(t,n,e){return s({url:t+(n&&Object.keys(n).length?"?"+$.param(n):"")},e)}function f(t,n,e){return s({url:t+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"HEAD"},e)}function i(t,n,e){return s({url:t,method:"POST",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function y(t,n,e){return s({url:t,method:"PATCH",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function A(t,n,e){return s({url:t,method:"PUT",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function r(t,n,e){return s({url:t,method:"DELETE",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}},6574:(D,E,o)=>{var d,p;d=[o(91749),o(52473),o(49897),o(29930)],p=function(c,P,v,s){const u={};let a,f,i;u.showFlagModal=function(r){app.parseAndTranslate("modals/flag",r,function(t){a=t,a.on("hidden.bs.modal",function(){a.remove()}),f=a.find("#flag-post-commit"),i=a.find("#flag-reason-custom"),a.on("click",'input[name="flag-reason"]',function(){$(this).attr("id")==="flag-reason-other"?(i.removeAttr("disabled"),i.val().length||f.attr("disabled",!0)):(i.attr("disabled",!0),f.removeAttr("disabled"))}),f.on("click",function(){const n=$('input[name="flag-reason"]:checked');let e=n.val();n.attr("id")==="flag-reason-other"&&(e=i.val()),y(r.type,r.id,e)}),a.on("click","#flag-reason-other",function(){i.focus()}),a.modal("show"),c.fire("action:flag.showModal",{modalEl:a,type:r.type,id:r.id}),a.find("#flag-reason-custom").on("keyup blur change",A)})},u.resolve=function(r){v.put(`/flags/${r}`,{state:"resolved"}).then(()=>{s.success("[[flags:resolved]]"),c.fire("action:flag.resolved",{flagId:r})}).catch(s.error)};function y(r,t,n){if(!r||!t||!n)return;const e={type:r,id:t,reason:n};v.post("/flags",e,function(h,g){if(h)return s.error(h);if(a.modal("hide"),s.success("[[flags:modal-submit-success]]"),r==="post"){const m=P.get("post","pid",t);m.find('[component="post/flag"]').addClass("hidden").parent().attr("hidden",""),m.find('[component="post/already-flagged"]').removeClass("hidden").parent().attr("hidden",null)}c.fire("action:flag.create",{flagId:g,data:e})})}function A(){a.find("#flag-reason-custom").val()?f.removeAttr("disabled"):f.attr("disabled",!0)}return u}.apply(E,d),p!==void 0&&(D.exports=p)}}]);
