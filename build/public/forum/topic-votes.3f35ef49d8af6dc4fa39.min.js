"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[63154,99127,34271,1091,49897],{34342:(O,v,a)=>{var c,y;c=[a(52473),a(17459),a(49897),a(91749),a(40027),a(29930),a(89336)],y=function(h,P,g,u,T,p,m){const f={};let d={};f.addVoteHandler=function(){d={},A()&&(h.get("topic").on("mouseenter",'[data-pid] [component="post/vote-count"]',o),h.get("topic").on("mouseleave",'[data-pid] [component="post/vote-count"]',t))};function A(){const{upvoteVisibility:r,privileges:i}=ajaxify.data;return i.isAdminOrMod||r==="all"||r==="loggedin"&&config.loggedIn}function D(){const{upvoteVisibility:r,downvoteVisibility:i,privileges:s}=ajaxify.data;return s.isAdminOrMod||r==="all"||i==="all"||(r==="loggedin"||i==="loggedin")&&config.loggedIn}function t(){const r=$(this),i=r.parents("[data-pid]").attr("data-pid"),s=m.Tooltip.getInstance(this);s&&(s.dispose(),r.attr("title","")),d[i]=!1}function o(){const r=$(this),s=r.parent().parents("[data-pid]").attr("data-pid");d[s]=!0;const n=m.Tooltip.getInstance(this);n&&(n.dispose(),r.attr("title","")),g.get(`/posts/${s}/upvoters`,{},function(l,E){if(l)return p.error(l);d[s]&&E&&e(r,E)})}function e(r,i){function s(l){r.attr("title",l),new m.Tooltip(r,{container:"#content",html:!0}).show()}let n=i.usernames.filter(l=>l!=="[[global:former-user]]");n.length&&(n.length+i.otherCount>i.cutoff?(n=n.join(", ").replace(/,/g,"|"),P.translate("[[topic:users-and-others, "+n+", "+i.otherCount+"]]",function(l){l=l.replace(/\|/g,","),s(l)})):(n=n.join(", "),s(n)))}return f.toggleVote=function(r,i,s){const n=r.closest("[data-pid]"),E=n.find(i).length?"del":"put",x=n.attr("data-pid");return g[E](`/posts/${x}/vote`,{delta:s},function(C){if(C){if(!app.user.uid){ajaxify.go("login");return}return p.error(C)}u.fire("action:post.toggleVote",{pid:x,delta:s,unvote:E==="del"})}),!1},f.showVotes=function(r){D()&&g.get(`/posts/${r}/voters`,{},function(i,s){if(i)return p.error(i);app.parseAndTranslate("modals/votes",s,function(n){const l=T.dialog({title:"[[global:voters]]",message:n,className:"vote-modal",show:!0,onEscape:!0,backdrop:!0});l.on("click",function(){l.modal("hide")})})})},f}.apply(v,c),y!==void 0&&(O.exports=y)},49897:(O,v,a)=>{a.r(v),a.d(v,{del:()=>D,get:()=>p,head:()=>m,patch:()=>d,post:()=>f,put:()=>A});var c=a(91749),y=a.n(c),h=a(40027),P=a.n(h);const g=config.relative_path+"/api/v3";async function u(t,o){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:g+t.url,typeof o=="function"){T(t).then(e=>o(null,e),e=>o(e));return}try{return await T(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again."){const{url:r}=await(0,c.fire)("filter:admin.reauth",{url:"login"});return(0,h.confirm)("[[error:api.reauth-required]]",i=>{i&&ajaxify.go(r)})}throw e}}async function T(t){const{url:o}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,c.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(o,t),{headers:r}=e,i=r.get("content-type"),s=i&&i.startsWith("application/json");let n;if(t.method!=="HEAD"&&(s?n=await e.json():n=await e.text()),!e.ok)throw n?new Error(s?n.status.message:n):new Error(e.statusText);return s&&n&&n.hasOwnProperty("status")&&n.hasOwnProperty("response")?n.response:n}function p(t,o,e){return u({url:t+(o&&Object.keys(o).length?"?"+$.param(o):"")},e)}function m(t,o,e){return u({url:t+(o&&Object.keys(o).length?"?"+$.param(o):""),method:"HEAD"},e)}function f(t,o,e){return u({url:t,method:"POST",data:o,headers:{"x-csrf-token":config.csrf_token}},e)}function d(t,o,e){return u({url:t,method:"PATCH",data:o,headers:{"x-csrf-token":config.csrf_token}},e)}function A(t,o,e){return u({url:t,method:"PUT",data:o,headers:{"x-csrf-token":config.csrf_token}},e)}function D(t,o,e){return u({url:t,method:"DELETE",data:o,headers:{"x-csrf-token":config.csrf_token}},e)}}}]);
