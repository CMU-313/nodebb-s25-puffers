"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[44864,99127,34271,1091,38395,49897,36422],{36422:(A,_,r)=>{var u,m;u=[r(16227),r(29930),r(49897)],m=function(c,a,E){const l={};let o,f,p,P;l.init=function(){P=ajaxify.data.tid,$(window).off("action:ajaxify.end",s).on("action:ajaxify.end",s),!o&&app.parseAndTranslate("modals/delete-posts",{},function(e){o=e,$("body").append(o),f=o.find("#delete_posts_confirm"),p=o.find("#purge_posts_confirm"),o.find("#delete_posts_cancel").on("click",n),c.init(function(){t(),h()}),h(),f.on("click",function(){i(f,g=>`/posts/${g}/state`)}),p.on("click",function(){i(p,g=>`/posts/${g}`)})})};function s(){(ajaxify.data.template.name!=="topic"||ajaxify.data.tid!==P)&&(n(),$(window).off("action:ajaxify.end",s))}function i(e,g){e.attr("disabled",!0),Promise.all(c.pids.map(y=>E.del(g(y),{}))).then(n).catch(a.error).finally(()=>{e.removeAttr("disabled")})}function h(){c.pids.length?o.find("#pids").translateHtml("[[topic:fork-pid-count, "+c.pids.length+"]]"):o.find("#pids").translateHtml("[[topic:fork-no-pids]]")}function t(){c.pids.length?(f.removeAttr("disabled"),p.removeAttr("disabled")):(f.attr("disabled",!0),p.attr("disabled",!0))}function n(){o&&(o.remove(),o=null,c.disable())}return l}.apply(_,u),m!==void 0&&(A.exports=m)},49897:(A,_,r)=>{r.r(_),r.d(_,{del:()=>h,get:()=>f,head:()=>p,patch:()=>s,post:()=>P,put:()=>i});var u=r(91749),m=r.n(u),c=r(40027),a=r.n(c);const E=config.relative_path+"/api/v3";async function l(t,n){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:E+t.url,typeof n=="function"){o(t).then(e=>n(null,e),e=>n(e));return}try{return await o(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again."){const{url:g}=await(0,u.fire)("filter:admin.reauth",{url:"login"});return(0,c.confirm)("[[error:api.reauth-required]]",y=>{y&&ajaxify.go(g)})}throw e}}async function o(t){const{url:n}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,u.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(n,t),{headers:g}=e,y=g.get("content-type"),k=y&&y.startsWith("application/json");let d;if(t.method!=="HEAD"&&(k?d=await e.json():d=await e.text()),!e.ok)throw d?new Error(k?d.status.message:d):new Error(e.statusText);return k&&d&&d.hasOwnProperty("status")&&d.hasOwnProperty("response")?d.response:d}function f(t,n,e){return l({url:t+(n&&Object.keys(n).length?"?"+$.param(n):"")},e)}function p(t,n,e){return l({url:t+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"HEAD"},e)}function P(t,n,e){return l({url:t,method:"POST",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function s(t,n,e){return l({url:t,method:"PATCH",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function i(t,n,e){return l({url:t,method:"PUT",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function h(t,n,e){return l({url:t,method:"DELETE",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}},16227:(A,_,r)=>{var u,m;u=[r(52473)],m=function(c){const a={};let E;a.pids=[];let l=!1;a.init=function(s,i){a.pids.length=0,E=s,i=i||{},l=i.allowMainPostSelect||!1,$("#content").on("click",'[component="topic"] [component="post"]',o),p()};function o(s){s.stopPropagation();const i=$(this).attr("data-pid"),h=$('[component="topic"] [data-pid="'+i+'"]');!l&&parseInt($(this).attr("data-index"),10)===0||a.togglePostSelection(h,i)}a.disable=function(){a.pids.forEach(function(s){c.get("post","pid",s).toggleClass("selected",!1)}),$("#content").off("click",'[component="topic"] [component="post"]',o),P()},a.togglePostSelection=function(s,i){if(i){const h=a.pids.indexOf(i);h===-1?(a.pids.push(i),s.toggleClass("selected",!0)):(a.pids.splice(h,1),s.toggleClass("selected",!1)),a.pids.length&&a.pids.sort(function(t,n){return t-n}),typeof E=="function"&&E()}};function f(){return!1}function p(){$("#content").on("click",'[component="post"] button, [component="post"] a',f)}function P(){$("#content").off("click",'[component="post"] button, [component="post"] a',f)}return a}.apply(_,u),m!==void 0&&(A.exports=m)}}]);
