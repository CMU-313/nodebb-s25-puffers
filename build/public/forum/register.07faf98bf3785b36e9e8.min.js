"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[89034,99127,19992,34271,1091,26174,49897],{97014:(L,x,i)=>{var g,h;g=[i(91749),i(17459),i(64061)],h=function(d,y){const l={_capsState:!1};return l.init=function(){const o=$("#login-error-notify"),u=$("#login"),v=$("#login-form");u.on("click",async function(p){p.preventDefault();const w=$("#username").val(),E=$("#password").val();if(o.addClass("hidden").find("p").text(""),!w||!E){o.find("p").translateText("[[error:invalid-username-or-password]]"),o.removeClass("hidden");return}if(!u.hasClass("disabled")){u.addClass("disabled");try{if((await d.fire("filter:app.login",{username:w,password:E,cancel:!1})).cancel){u.removeClass("disabled");return}}catch(c){o.find("p").translateText(c.message),o.removeClass("hidden"),u.removeClass("disabled");return}d.fire("action:app.login"),v.ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},beforeSend:function(){app.flags._login=!0},success:function(c){d.fire("action:app.loggedIn",c);const C=utils.urlToLocation(c.next).pathname,e=utils.params({url:c.next});e.loggedin=!0,delete e.register;const t=decodeURIComponent($.param(e));window.location.href=C+"?"+t},error:function(c){let C=c.responseText;const e=c.responseJSON;c.status===403&&c.responseText==="Forbidden"?window.location.href=config.relative_path+"/login?error=csrf-invalid":e&&e.hasOwnProperty("banned_until")&&(C=e.banned_until?y.compile("error:user-banned-reason-until",new Date(e.banned_until).toLocaleString(),e.reason):"[[error:user-banned-reason, "+e.reason+"]]"),o.find("p").translateText(C),o.removeClass("hidden"),u.removeClass("disabled"),$("#password:focus").length&&$("#password").select()}})}}),l.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),$("#content #username").val()?$("#content #password").val("").focus():$("#content #username").focus(),$("#content #noscript").val("false")},l.capsLockCheck=(o,u)=>{const v=p=>{u.classList[p?"remove":"add"]("hidden"),u.parentNode.classList[p?"add":"remove"]("has-warning")};o&&(o.addEventListener("keyup",function(p){if(l._capsState&&p.key==="CapsLock"){v(!1),l._capsState=!l._capsState;return}l._capsState=p.getModifierState&&p.getModifierState("CapsLock"),v(l._capsState)}),l._capsState&&v(!0))},l}.apply(x,g),h!==void 0&&(L.exports=h)},10034:(L,x,i)=>{var g,h;g=[i(17459),i(13230),i(49897),i(40027),i(97014),i(7065),i(64061)],h=function(d,y,l,o,u,v){const p={};let w=!1;const E="";p.init=function(){const s=$("#username"),a=$("#password"),n=$("#password-confirm"),f=$("#register");D(),$("#content #noscript").val("false");const m=utils.params();m.token&&$("#token").val(m.token),s.on("keyup",function(){$("#yourUsername").text(this.value.length>0?y(this.value):"username")}),s.on("blur",function(){s.val().length&&c(s.val())}),a.on("blur",function(){a.val().length&&C(a.val(),n.val())}),n.on("blur",function(){n.val().length&&e(a.val(),n.val())});function A(S){w=!1,$('[aria-invalid="true"]').removeAttr("aria-invalid"),C(a.val(),n.val()),e(a.val(),n.val()),c(s.val(),S)}u.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),f.on("click",function(S){const T=$(this),k=$("#register-error-notify");k.addClass("hidden"),S.preventDefault(),A(function(){w||(T.addClass("disabled"),T.parents("form").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},success:function(_){if(T.removeClass("disabled"),!!_)if(_.next){const P=utils.urlToLocation(_.next).pathname,b=utils.params({url:_.next});b.registered=!0;const I=decodeURIComponent($.param(b));window.location.href=P+"?"+I}else _.message&&d.translate(_.message,function(P){o.alert(P),ajaxify.go("/")})},error:function(_){d.translate(_.responseText,config.defaultLang,function(P){_.status===403&&_.responseText==="Forbidden"?window.location.href=config.relative_path+"/register?error=csrf-invalid":(k.find("p").text(P),k.removeClass("hidden"),T.removeClass("disabled"))})}}))})}),$("#username").trigger("focus")};function c(s,a){a=a||function(){};const n=$("#username-notify");n.text("");const f=$("#username"),m=y(s);s.length<ajaxify.data.minimumUsernameLength||m.length<ajaxify.data.minimumUsernameLength?t(f,n,"[[error:username-too-short]]"):s.length>ajaxify.data.maximumUsernameLength?t(f,n,"[[error:username-too-long]]"):!utils.isUserNameValid(s)||!m?t(f,n,"[[error:invalid-username]]"):Promise.allSettled([l.head(`/users/bySlug/${m}`,{}),l.head(`/groups/${s}`,{})]).then(A=>{A.every(S=>S.status==="rejected")?r(f,n,E):t(f,n,"[[error:username-taken]]"),a()})}function C(s,a){const n=$("#password"),f=$("#password-notify"),m=$("#password-confirm-notify");f.text(""),m.text("");try{if(utils.assertPasswordValidity(s,v),s===$("#username").val())throw new Error("[[user:password-same-as-username]]");r(n,f,E)}catch(A){t(n,f,A.message)}s!==a&&a!==""&&t(n,m,"[[user:change-password-error-match]]")}function e(s,a){const n=$("#password-confirm"),f=$("#password-notify"),m=$("#password-confirm-notify");m.text(""),!(!s||f.hasClass("alert-error"))&&(s!==a?t(n,m,"[[user:change-password-error-match]]"):r(n,m,E))}function t(s,a,n){d.translate(n,function(f){s.attr("aria-invalid","true"),a.html(f),a.parent().removeClass("register-success").addClass("register-danger"),a.show()}),w=!0}function r(s,a,n){d.translate(n,function(f){s.removeAttr("aria-invalid"),a.html(f),a.parent().removeClass("register-danger").addClass("register-success"),a.show()})}function D(){if(!app.user.uid&&config.defaultLang!==config.userLang){const s=$('[component="register/local"]'),a=$('<input type="hidden" name="userLang" value="'+config.userLang+'" />');s.append(a)}}return p}.apply(x,g),h!==void 0&&(L.exports=h)},49897:(L,x,i)=>{i.r(x),i.d(x,{del:()=>C,get:()=>v,head:()=>p,patch:()=>E,post:()=>w,put:()=>c});var g=i(91749),h=i.n(g),d=i(40027),y=i.n(d);const l=config.relative_path+"/api/v3";async function o(e,t){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:l+e.url,typeof t=="function"){u(e).then(r=>t(null,r),r=>t(r));return}try{return await u(e)}catch(r){if(r.message==="A valid login session was not found. Please log in and try again."){const{url:D}=await(0,g.fire)("filter:admin.reauth",{url:"login"});return(0,d.confirm)("[[error:api.reauth-required]]",s=>{s&&ajaxify.go(D)})}throw r}}async function u(e){const{url:t}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,g.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const r=await fetch(t,e),{headers:D}=r,s=D.get("content-type"),a=s&&s.startsWith("application/json");let n;if(e.method!=="HEAD"&&(a?n=await r.json():n=await r.text()),!r.ok)throw n?new Error(a?n.status.message:n):new Error(r.statusText);return a&&n&&n.hasOwnProperty("status")&&n.hasOwnProperty("response")?n.response:n}function v(e,t,r){return o({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},r)}function p(e,t,r){return o({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"HEAD"},r)}function w(e,t,r){return o({url:e,method:"POST",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function E(e,t,r){return o({url:e,method:"PATCH",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function c(e,t,r){return o({url:e,method:"PUT",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function C(e,t,r){return o({url:e,method:"DELETE",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}},13230:(L,x,i)=>{var g,h,d;(function(y){h=[i(53050)],g=y,d=typeof g=="function"?g.apply(x,h):g,d!==void 0&&(L.exports=d)})(function(y){const l=y("[^\\p{L}\\s\\d\\-_]","g"),o=/[^\w\s\d\-_]/g,u=/^\s+|\s+$/g,v=/\s+/g,p=/-+/g,w=/-$/g,E=/^-/g,c=/^[\w\d\s.,\-@]+$/;return function(e,t){return e?(e=String(e).replace(u,""),c.test(e)?e=e.replace(o,"-"):e=y.replace(e,l,"-"),e=t?e:e.toLocaleLowerCase(),e=e.replace(v,"-"),e=e.replace(p,"-"),e=e.replace(w,""),e=e.replace(E,""),e):""}})}}]);
