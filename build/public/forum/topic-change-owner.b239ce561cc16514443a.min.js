"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[3097,99127,34271,13417,1091,38395,49897,17205,34405],{17205:(P,E,d)=>{var g,m;g=[d(16227),d(34405),d(29930)],m=function(p,r,f){const h={};let c,u,i=0;h.init=function(e){c||app.parseAndTranslate("modals/change-owner",{},function(n){c=n,u=c.find("#change_owner_commit"),$("body").append(c),c.find("#change_owner_cancel").on("click",t),c.find("#username").on("keyup",a),p.init(o,{allowMainPostSelect:!0}),l(),e&&p.togglePostSelection(e,e.attr("data-pid")),u.on("click",function(){s()}),r.user(c.find("#username"),{filters:["notbanned"]},function(y,A){i=A.item.user.uid,a()})})};function l(){p.pids.length?c.find("#pids").translateHtml("[[topic:fork-pid-count, "+p.pids.length+"]]"):c.find("#pids").translateHtml("[[topic:fork-no-pids]]")}function a(){i&&c.find("#username").length&&c.find("#username").val().length&&p.pids.length?u.removeAttr("disabled"):u.attr("disabled",!0)}function o(){a(),l()}function s(){i&&socket.emit("posts.changeOwner",{pids:p.pids,toUid:i},function(e){if(e)return f.error(e);ajaxify.go(`/post/${p.pids[0]}`),t()})}function t(){c&&(c.remove(),c=null,p.disable())}return h}.apply(E,g),m!==void 0&&(P.exports=m)},49897:(P,E,d)=>{d.r(E),d.d(E,{del:()=>s,get:()=>u,head:()=>i,patch:()=>a,post:()=>l,put:()=>o});var g=d(91749),m=d.n(g),p=d(40027),r=d.n(p);const f=config.relative_path+"/api/v3";async function h(t,e){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:f+t.url,typeof e=="function"){c(t).then(n=>e(null,n),n=>e(n));return}try{return await c(t)}catch(n){if(n.message==="A valid login session was not found. Please log in and try again."){const{url:y}=await(0,g.fire)("filter:admin.reauth",{url:"login"});return(0,p.confirm)("[[error:api.reauth-required]]",A=>{A&&ajaxify.go(y)})}throw n}}async function c(t){const{url:e}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,g.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const n=await fetch(e,t),{headers:y}=n,A=y.get("content-type"),k=A&&A.startsWith("application/json");let _;if(t.method!=="HEAD"&&(k?_=await n.json():_=await n.text()),!n.ok)throw _?new Error(k?_.status.message:_):new Error(n.statusText);return k&&_&&_.hasOwnProperty("status")&&_.hasOwnProperty("response")?_.response:_}function u(t,e,n){return h({url:t+(e&&Object.keys(e).length?"?"+$.param(e):"")},n)}function i(t,e,n){return h({url:t+(e&&Object.keys(e).length?"?"+$.param(e):""),method:"HEAD"},n)}function l(t,e,n){return h({url:t,method:"POST",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function a(t,e,n){return h({url:t,method:"PATCH",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function o(t,e,n){return h({url:t,method:"PUT",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function s(t,e,n){return h({url:t,method:"DELETE",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}},34405:(P,E,d)=>{var g,m;g=[d(49897),d(29930)],m=function(p,r){const f={},h={delay:200,appendTo:null};f.init=u=>{const i={...h,...u},{input:l,onSelect:a}=i;app.loadJQueryUI(function(){l.autocomplete({...i,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(o,s){c(l,a,o,s)}})})},f.user=function(u,i,l){typeof i=="function"&&(l=i,i={}),i=i||{},f.init({input:u,onSelect:l,source:(a,o)=>{i.query=a.term,p.get("/api/users",i,function(s,t){if(s)return r.error(s);if(t&&t.users){const e=t.users.map(function(n){const y=$("<div></div>").html(n.username).text();return n&&{label:y,value:y,user:{uid:n.uid,name:n.username,slug:n.userslug,username:n.username,userslug:n.userslug,picture:n.picture,banned:n.banned,"icon:text":n["icon:text"],"icon:bgColor":n["icon:bgColor"]}}});o(e)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},f.group=function(u,i){f.init({input:u,onSelect:i,source:(l,a)=>{socket.emit("groups.search",{query:l.term},function(o,s){if(o)return r.error(o);if(s&&s.length){const t=s.map(function(e){return e&&{label:e.name,value:e.name,group:e}});a(t)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},f.tag=function(u,i){f.init({input:u,onSelect:i,delay:100,source:(l,a)=>{socket.emit("topics.autocompleteTags",{query:l.term,cid:ajaxify.data.cid||0},function(o,s){if(o)return r.error(o);s&&a(s),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function c(u,i,l,a){i=i||function(){};const o=jQuery.Event("keypress");o.which=13,o.keyCode=13,setTimeout(function(){u.trigger(o)},100),i(l,a)}return f}.apply(E,g),m!==void 0&&(P.exports=m)},16227:(P,E,d)=>{var g,m;g=[d(52473)],m=function(p){const r={};let f;r.pids=[];let h=!1;r.init=function(a,o){r.pids.length=0,f=a,o=o||{},h=o.allowMainPostSelect||!1,$("#content").on("click",'[component="topic"] [component="post"]',c),i()};function c(a){a.stopPropagation();const o=$(this).attr("data-pid"),s=$('[component="topic"] [data-pid="'+o+'"]');!h&&parseInt($(this).attr("data-index"),10)===0||r.togglePostSelection(s,o)}r.disable=function(){r.pids.forEach(function(a){p.get("post","pid",a).toggleClass("selected",!1)}),$("#content").off("click",'[component="topic"] [component="post"]',c),l()},r.togglePostSelection=function(a,o){if(o){const s=r.pids.indexOf(o);s===-1?(r.pids.push(o),a.toggleClass("selected",!0)):(r.pids.splice(s,1),a.toggleClass("selected",!1)),r.pids.length&&r.pids.sort(function(t,e){return t-e}),typeof f=="function"&&f()}};function u(){return!1}function i(){$("#content").on("click",'[component="post"] button, [component="post"] a',u)}function l(){$("#content").off("click",'[component="post"] button, [component="post"] a',u)}return r}.apply(E,g),m!==void 0&&(P.exports=m)}}]);
