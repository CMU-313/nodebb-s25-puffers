(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[27810,98088,25285,33069,98463],{22148:(k,C,e)=>{"use strict";var E,h;E=[e(22410),e(60984),e(8454),e(57642),e(47536),e(96352),e(43349),e(95692),e(52473),e(68636),e(91749),e(49897),e(29930),e(40027),e(57576)],h=function(m,y,s,b,x,n,l,d,t,i,a,r,g,v,S){const I={};let A=0,P="";$(window).on("action:ajaxify.start",function(c,u){b.removeListeners(),String(u.url).startsWith("topic/")||(n.disable(),t.get("navbar/title").find("span").text("").hide(),g.remove("bookmark"))}),I.init=async function(){const c=!A||parseInt(A,10)!==parseInt(ajaxify.data.tid,10);A=ajaxify.data.tid,P=ajaxify.currentPage,a.fire("action:topic.loading"),app.enterRoom("topic_"+A),c&&(x.signaturesShown={}),await x.onTopicPageLoad(t.get("post")),n.init('[component="topic"]>[component="post"]',ajaxify.data.postcount,I.toTop,I.toBottom,I.navigatorCallback),s.init(A),y.init(A,$(".topic")),b.init(),l.handleSort("topicPostSort","topic/"+ajaxify.data.slug),config.usePagination||m.init($('[component="topic"]'),x.loadMorePosts),U(),o(),j(),R(),N(),K(),O(A),L(),$(window).on("scroll",utils.debounce(Y,250)),B(),a.fire("action:topic.loaded",ajaxify.data)};function B(){Promise.resolve().then(function(){var c=[e(6411)];(u=>{config.topicSearchEnabled&&Promise.resolve().then(function(){var p=[e(69749)];(function(f){u.bind(["command+f","ctrl+f"],function(T){T.preventDefault();let D=$('[component="navbar"] [component="search/form"]');D.length||(D=$('[component="sidebar/right"] [component="search/form"]')),D.find('[component="search/fields"] input[name="query"]').val("in:topic-"+ajaxify.data.tid+" "),f.showAndFocusInput(D)}),a.onPage("action:ajaxify.cleanup",()=>{u.unbind(["command+f","ctrl+f"])})}).apply(null,p)}).catch(e.oe),u.bind("j",p=>{if(p.target.classList.contains("mousetrap"))return;const f=n.getIndex(),T=n.getCount();f!==T&&n.scrollToIndex(f,!0,0)}),u.bind("k",p=>{if(p.target.classList.contains("mousetrap"))return;const f=n.getIndex();f!==1&&n.scrollToIndex(f-2,!0,0)})}).apply(null,c)}).catch(e.oe)}I.toTop=function(){n.scrollTop(0)},I.toBottom=function(){socket.emit("topics.postcount",ajaxify.data.tid,function(c,u){if(c)return g.error(c);n.scrollBottom(u-1)})};function O(c){if(window.location.hash){const f=$(utils.escapeHTML(window.location.hash));if(f.length){const T=f.parents("[data-pid]");return n.scrollToElement(T,!0,0)}}const u=ajaxify.data.bookmark||i.getItem("topic:"+c+":bookmark"),p=ajaxify.data.postIndex;if(H(p),n.shouldScrollToPost(p))return n.scrollToPostIndex(p-1,!0,0);u&&(!config.usePagination||config.usePagination&&ajaxify.data.pagination.currentPage===1)&&ajaxify.data.postcount>ajaxify.data.bookmarkThreshold&&g.alert({alert_id:"bookmark",message:"[[topic:bookmark-instructions]]",timeout:15e3,type:"info",clickfn:function(){n.scrollToIndex(Math.max(0,parseInt(u,10)-1),!0)},closefn:function(){i.removeItem("topic:"+c+":bookmark")}})}function L(){const c=document.querySelector('[component="topic/thumb/list"]');c&&c.addEventListener("click",async u=>{const p=u.target.closest("a");if(p){const f=Array.from(p.parentNode.children).indexOf(p);u.preventDefault();const T=ajaxify.data.thumbs.map(w=>({...w}));T.forEach((w,z)=>{w.selected=z===f});const D=await app.parseAndTranslate("modals/topic-thumbs-view",{src:p.href,thumbs:T});v.dialog({size:"lg",onEscape:!0,backdrop:!0,message:D}).on("click",'[component="topic/thumb/select"]',function(){$('[component="topic/thumb/select"]').removeClass("border-primary"),$(this).addClass("border-primary"),$('[component="topic/thumb/current"]').attr("src",$(this).attr("src"))})}})}function U(){t.get("topic").on("click","blockquote .toggle",function(){const c=$(this).parent("blockquote"),u=$(this);c.toggleClass("uncollapsed");const p=!c.hasClass("uncollapsed");u.toggleClass("fa-angle-down",p).toggleClass("fa-angle-up",!p)})}function o(){new S('[component="copy/code/btn"]',{text:function(u){const p=$(u);p.find("i").removeClass("fa-copy").addClass("fa-check"),setTimeout(()=>p.find("i").removeClass("fa-check").addClass("fa-copy"),2e3);const f=p.parent().find("code");return f.attr("data-lines")&&f.find(".hljs-ln-code[data-line-number]").length?f.find(".hljs-ln-code[data-line-number]").map((T,D)=>D.textContent).get().join(`
`):f.text()}});function c(){function u(w){return w.scrollHeight>w.clientHeight}function p(w){if(w.length){if(!w[0].scrollHeight)return setTimeout(p,100,w);u(w.get(0))&&w.parent().parent().find('[component="copy/code/btn"]').css({margin:"0.5rem 1.5rem 0 0"})}}let f=$('[component="topic"] [component="post/content"] code:not([data-button-added])');f=f.filter((w,z)=>$(z).text().includes(`
`));const T=$('<div class="hover-parent position-relative"></div>'),D=$('<button component="copy/code/btn" class="hover-visible position-absolute top-0 btn btn-sm btn-outline-secondary" style="right: 0px; margin: 0.5rem 0.5rem 0 0;"><i class="fa fa-fw fa-copy"></i></button>'),F=f.parent();F.wrap(T).parent().append(D),F.parent().find('[component="copy/code/btn"]').translateAttr("title","[[topic:copy-code]]"),F.each((w,z)=>{p($(z).find("code"))}),f.attr("data-button-added",1)}a.registerPage("action:posts.loaded",c),a.registerPage("action:topic.loaded",c),a.registerPage("action:posts.edited",c)}function j(){t.get("topic").on("click",'[component="post/parent"]',function(c){const u=$(this).attr("data-topid"),p=$('[component="topic"]>[component="post"][data-pid="'+u+'"]');if(p.length)return c.preventDefault(),n.scrollToIndex(p.attr("data-index"),!0),!1})}function R(){$('[component="topic"]').on("click",'[component="post/reply-count"]',function(){const c=$(this);e.e(18631).then(function(){var u=[e(18631)];(function(p){p.init(c)}).apply(null,u)}).catch(e.oe)})}function N(){if(!ajaxify.data.showPostPreviewsOnHover||utils.isMobile())return;let c=0,u=!1;const p={};function f(){clearTimeout(c),$("#post-tooltip").remove(),u=!0}$(window).one("action:ajaxify.start",f),$('[component="topic"]').on("mouseenter",'[component="post/parent"], [component="post/content"] a, [component="topic/event"] a',async function(){const T=$(this);u=!1;async function D(W){const M=p[W]||await r.get(`/posts/${W}/summary`);if($("#post-tooltip").remove(),M&&ajaxify.data.template.topic){p[W]=M;const Q=await app.parseAndTranslate("partials/topic/post-preview",{post:M});if(u)return;Q.hide().find(".timeago").timeago(),Q.appendTo($("body")).fadeIn(300);const X=T.parents('[component="topic"]').find('[component="post/content"]').first(),Z=X.offset(),q=X.width(),_=T.offset();Q.css({top:_.top+30,left:Z.left,width:q})}}const F=T.attr("href"),w=utils.urlToLocation(F),z=w.pathname,J=F&&F!=="#"&&window.location.hostname===w.hostname;$("#post-tooltip").remove();const V=J&&z&&z.match(/\/post\/([\d]+)/),G=J&&z&&z.match(/\/topic\/([\d]+)/);if(V){const W=V[1];if(parseInt(T.parents('[component="post"]').attr("data-pid"),10)===parseInt(W,10))return;c=setTimeout(async()=>{D(W)},300)}else G&&(c=setTimeout(async()=>{const W=G[1],M=await r.get("/topics/"+W,{});D(M.mainPid)},300))}).on("mouseleave",'[component="post"] a, [component="topic/event"] a',f)}function K(){(config.enableQuickReply||config.theme&&config.theme.enableQuickReply)&&d.init()}function Y(){const c=t.get("navbar/title").find("span");$(window).scrollTop()>50&&c.hasClass("hidden")?c.html(ajaxify.data.title).removeClass("hidden"):$(window).scrollTop()<=50&&!c.hasClass("hidden")&&c.html("").addClass("hidden"),$(window).scrollTop()>300&&g.remove("bookmark")}I.navigatorCallback=function(c,u){if(!ajaxify.data.template.topic||n.scrollActive)return;const p="topic/"+ajaxify.data.slug+(c>1?"/"+c:"");if(p!==P&&(P=p,c>=u&&app.user.uid&&r.put(`/topics/${ajaxify.data.tid}/read`),H(c),ajaxify.data.updateUrlWithPostIndex&&history.replaceState)){let f=window.location.search||"";config.usePagination||(f=f&&!/^\?page=\d+$/.test(f)?f:""),history.replaceState({url:p+f},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+p+f)}};function H(c){const u="topic:"+ajaxify.data.tid+":bookmark",p=ajaxify.data.bookmark||i.getItem(u);config.topicPostSort==="newest_to_oldest"&&(c=Math.max(1,ajaxify.data.postcount-c+2)),ajaxify.data.postcount>ajaxify.data.bookmarkThreshold&&(!p||parseInt(c,10)>parseInt(p,10)||ajaxify.data.postcount<parseInt(p,10))&&(app.user.uid?(ajaxify.data.bookmark=Math.min(c,ajaxify.data.postcount),socket.emit("topics.bookmark",{tid:ajaxify.data.tid,index:ajaxify.data.bookmark},function(f){if(f)return ajaxify.data.bookmark=p,g.error(f)})):i.setItem(u,c)),(!p||parseInt(c,10)>=parseInt(p,10))&&g.remove("bookmark")}return I}.apply(C,E),h!==void 0&&(k.exports=h)},57642:(k,C,e)=>{"use strict";var E,h;E=[e(8454),e(60984),e(47536),e(2269),e(52473),e(17459),e(91749),e(30076)],h=function(m,y,s,b,x,n,l,d){const t={},i=window.moment||e(95093),a={"event:user_status_change":r,"event:voted":g,"event:bookmarked":v,"event:topic_deleted":y.setDeleteState,"event:topic_restored":y.setDeleteState,"event:topic_purged":S,"event:topic_locked":y.setLockedState,"event:topic_unlocked":y.setLockedState,"event:topic_pinned":y.setPinnedState,"event:topic_unpinned":y.setPinnedState,"event:topic_moved":I,"event:post_edited":A,"event:post_purged":P,"event:post_deleted":B,"event:post_restored":B,"posts.bookmark":O,"posts.unbookmark":O,"posts.upvote":L,"posts.downvote":L,"posts.unvote":L,"event:new_notification":U,"event:new_post":s.onNewPost};t.init=function(){t.removeListeners();for(const o in a)a.hasOwnProperty(o)&&socket.on(o,a[o])},t.removeListeners=function(){for(const o in a)a.hasOwnProperty(o)&&socket.removeListener(o,a[o])};function r(o){app.updateUserStatus($('[data-uid="'+o.uid+'"] [component="user/status"]'),o.status)}function g(o){const j=$('[data-pid="'+o.post.pid+'"] [component="post/vote-count"]').filter(function(N,K){return parseInt($(K).closest("[data-pid]").attr("data-pid"),10)===parseInt(o.post.pid,10)}),R=$('.reputation[data-uid="'+o.post.uid+'"]');j.html(o.post.votes).attr("data-votes",o.post.votes),R.html(o.user.reputation).attr("data-reputation",o.user.reputation)}function v(o){$('[data-pid="'+o.post.pid+'"] .bookmarkCount').filter(function(j,R){return parseInt($(R).closest("[data-pid]").attr("data-pid"),10)===parseInt(o.post.pid,10)}).html(o.post.bookmarks).attr("data-bookmarks",o.post.bookmarks)}function S(o){ajaxify.data.category&&ajaxify.data.category.slug&&parseInt(o.tid,10)===parseInt(ajaxify.data.tid,10)&&ajaxify.go("category/"+ajaxify.data.category.slug,null,!0)}function I(o){o&&o.slug&&parseInt(o.tid,10)===parseInt(ajaxify.data.tid,10)&&ajaxify.go("topic/"+o.slug,null,!0)}function A(o){if(!o||!o.post||parseInt(o.post.tid,10)!==parseInt(ajaxify.data.tid,10))return;const j=x.get("post/content",o.post.pid).filter(function(c,u){return parseInt($(u).closest("[data-pid]").attr("data-pid"),10)===parseInt(o.post.pid,10)}),R=$(`[data-pid="${o.post.pid}"]`),N=R.find('[component="post/editor"]').filter(function(c,u){return parseInt($(u).closest("[data-pid]").attr("data-pid"),10)===parseInt(o.post.pid,10)}),K=x.get("topic/title"),Y=x.get("navbar/title").find("span"),H=x.get("breadcrumb/current");if(o.topic.rescheduled)return ajaxify.go("topic/"+o.topic.slug,null,!0);if(K.length&&o.topic.title&&o.topic.renamed){ajaxify.data.title=o.topic.title;const c="topic/"+o.topic.slug+(window.location.search?window.location.search:"");history.replaceState({url:c},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+c),K.fadeOut(250,function(){K.html(o.topic.title).fadeIn(250)}),H.fadeOut(250,function(){H.html(o.topic.title).fadeIn(250)}),Y.fadeOut(250,function(){Y.html(o.topic.title).fadeIn(250)})}o.post.changed?j.fadeOut(250,function(){if(j.html(n.unescape(o.post.content)),j.find("img:not(.not-responsive)").addClass("img-fluid"),b.wrapImagesInLinks(j.parent()),s.addBlockquoteEllipses(j.parent()),j.fadeIn(250),o.post.edited){const c={editor:o.editor,editedTimeAgo:o.post.editedTimeAgo};app.parseAndTranslate("partials/topic/post-editor",c,function(u){N.replaceWith(u),R.find('[component="post/edit-indicator"]').removeClass("hidden").text(`Edited: ${c.editedTimeAgo}`),l.fire("action:posts.edited",o)})}}):l.fire("action:posts.edited",o),o.topic.tags&&o.topic.tagsupdated&&e.e(63).then(function(){var c=[e(63)];(function(u){u.updateTopicTags([o.topic])}).apply(null,c)}).catch(e.oe),m.removeMenu(x.get("post","pid",o.post.pid))}function P(o){!o||parseInt(o.tid,10)!==parseInt(ajaxify.data.tid,10)||(x.get("post","pid",o.pid).fadeOut(500,function(){$(this).remove(),s.showBottomPostBar()}),ajaxify.data.postcount-=1,m.updatePostCount(ajaxify.data.postcount),e.e(18631).then(function(){var j=[e(18631)];(function(R){R.onPostPurged(o)}).apply(null,j)}).catch(e.oe))}function B(o){const j=x.get("post","pid",o.pid);if(!j.length)return;j.toggleClass("deleted");const R=j.hasClass("deleted");m.toggle(o.pid,R),!ajaxify.data.privileges.isAdminOrMod&&parseInt(o.uid,10)!==parseInt(app.user.uid,10)&&(j.find('[component="post/tools"]').toggleClass("hidden",R),R?j.find('[component="post/content"]').translateHtml("[[topic:post-is-deleted]]"):j.find('[component="post/content"]').html(n.unescape(o.content)))}function O(o){const j=$('[data-pid="'+o.post.pid+'"] [component="post/bookmark"]').filter(function(R,N){return parseInt($(N).closest("[data-pid]").attr("data-pid"),10)===parseInt(o.post.pid,10)});j.length&&(j.attr("data-bookmarked",o.isBookmarked),j.find('[component="post/bookmark/on"]').toggleClass("hidden",!o.isBookmarked),j.find('[component="post/bookmark/off"]').toggleClass("hidden",o.isBookmarked))}function L(o){const j=$('[data-pid="'+o.post.pid+'"]');j.find('[component="post/upvote"]').filter(function(R,N){return parseInt($(N).closest("[data-pid]").attr("data-pid"),10)===parseInt(o.post.pid,10)}).toggleClass("upvoted",o.upvote),j.find('[component="post/downvote"]').filter(function(R,N){return parseInt($(N).closest("[data-pid]").attr("data-pid"),10)===parseInt(o.post.pid,10)}).toggleClass("downvoted",o.downvote)}function U(o){const j=ajaxify.data.tid;o&&o.tid&&parseInt(o.tid,10)===parseInt(j,10)&&socket.emit("topics.markTopicNotificationsRead",[j])}return t}.apply(C,E),h!==void 0&&(k.exports=h)},74566:(k,C,e)=>{k.exports=e(12236)},449:(k,C,e)=>{k.exports=e(91943)},89596:(k,C,e)=>{k.exports=e(62590)},99594:(k,C,e)=>{k.exports=e(57904)},95692:(k,C,e)=>{"use strict";var E,h;E=[e(52473),e(71431),e(88518),e(49897),e(29930),e(43103),e(6411),e(68636),e(91749)],h=function(m,y,s,b,x,n,l,d,t){const i={};i.init=function(){const r=m.get("topic/quickreply/text"),g=`qr:draft:tid:${ajaxify.data.tid}`,v={element:r,strategies:[],options:{style:{"z-index":100}}};a(),$(window).one("action:ajaxify.start",()=>{a()}),$(window).trigger("composer:autocomplete:init",v),s._active.core_qr=s.setup(v),l.bind("ctrl+return",A=>{A.target===r.get(0)&&m.get("topic/quickreply/button").get(0).click()}),n.init({dragDropAreaEl:$('[component="topic/quickreply/container"] .quickreply-message'),pasteEl:r,uploadFormEl:$('[component="topic/quickreply/upload"]'),inputEl:r,route:"/api/post/upload",callback:function(A){let P=r.val();A.forEach(B=>{P=P+(P?`
`:"")+(B.isImage?"!":"")+`[${B.filename}](${B.url})`}),r.val(P)}});let S=!0;m.get("topic/quickreply/button").on("click",function(A){if(A.preventDefault(),!S)return;const P=m.get("topic/quickreply/text").val(),B={tid:ajaxify.data.tid,handle:void 0,content:P},O=P.length;if(O<parseInt(config.minimumPostLength,10))return x.error("[[error:content-too-short, "+config.minimumPostLength+"]]");if(O>parseInt(config.maximumPostLength,10))return x.error("[[error:content-too-long, "+config.maximumPostLength+"]]");S=!1,b.post(`/topics/${ajaxify.data.tid}`,B,function(L,U){if(S=!0,L)return x.error(L);U&&U.queued&&x.alert({type:"success",title:"[[global:alert.success]]",message:U.message,timeout:1e4,clickfn:function(){ajaxify.go(`/post-queue/${U.id}`)}}),m.get("topic/quickreply/text").val(""),d.removeItem(g),s._active.core_qr.hide(),t.fire("action:quickreply.success",{data:U})})});const I=d.getItem(g);I&&r.val(I),r.on("keyup",utils.debounce(function(){const A=r.val();A?d.setItem(g,A):d.removeItem(g)},1e3)),m.get("topic/quickreply/expand").on("click",A=>{A.preventDefault(),d.removeItem(g);const P=m.get("topic/quickreply/text");y.newReply({tid:ajaxify.data.tid,title:ajaxify.data.titleRaw,body:P.val()}),P.val("")})};function a(){s._active.core_qr&&(s._active.core_qr.destroy(),s._active.core_qr=null)}return i}.apply(C,E),h!==void 0&&(k.exports=h)},43349:(k,C,e)=>{"use strict";var E,h;E=[e(52473)],h=function(m){const y={};return y.handleSort=function(s,b){const x=m.get("thread/sort");x.find("i").removeClass("fa-check");const n=utils.params().sort||config[s];x.find('a[data-sort="'+n+'"]').find("i").addClass("fa-check"),$("body").off("click",'[component="thread/sort"] a[data-sort]').on("click",'[component="thread/sort"] a[data-sort]',function(){const d=$(this).attr("data-sort"),t=utils.params();t.sort=d;const i=decodeURIComponent($.param(t));ajaxify.go(b+(i?"?"+i:""))})},y}.apply(C,E),h!==void 0&&(k.exports=h)},14063:(k,C,e)=>{"use strict";k=e.nmd(k);var E,h;E=[e(17459),e(91749)],h=function(m,y){const s={};let b=!1;s.init=function(){if(s.taskbar=$('[component="taskbar"]'),s.tasklist=s.taskbar.find("ul"),!s.taskbar.length||!s.tasklist.length){b=!0;return}s.taskbar.on("click","li",async function(){const t=$(this),i=t.attr("data-module"),a=t.attr("data-uuid"),r=await app.require(i);return t.hasClass("active")?r.minimize(a):(n(),r.load(a),s.toggleNew(a,!1),s.tasklist.removeClass("active"),t.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){s.closeAll()})},s.close=async function(t,i){if(b)return;if(s.tasklist.find('[data-module="'+k+'"][data-uuid="'+i+'"]').length){const r=await app.require(t);r&&typeof r.close=="function"&&r.close(i)}},s.closeAll=function(t){if(b)return;let i="[data-uuid]";t&&(i='[data-module="'+t+'"]'+i),s.tasklist.find(i).each(function(a,r){s.close(t||r.getAttribute("data-module"),r.getAttribute("data-uuid"))})},s.discard=function(t,i){if(b)return;s.tasklist.find('[data-module="'+t+'"][data-uuid="'+i+'"]').remove(),x()},s.push=function(t,i,a,r){if(r=r||function(){},b)return r();const g=s.tasklist.find('li[data-uuid="'+i+'"]'),v={module:t,uuid:i,options:a,element:g};y.fire("filter:taskbar.push",v),!g.length&&v.module?l(v,r):r(g)},s.get=function(t){return b?[]:$('[data-module="'+t+'"]').map(function(a,r){return $(r).data()})},s.minimize=function(t,i){if(b)return;s.tasklist.find('[data-module="'+t+'"][data-uuid="'+i+'"]').toggleClass("active",!1)},s.toggleNew=function(t,i,a){if(b)return;s.tasklist.find('[data-uuid="'+t+'"]').toggleClass("new",i),a||y.fire("action:taskbar.toggleNew",t)},s.updateActive=function(t){if(b)return;const i=s.tasklist.find("li");i.removeClass("active"),i.filter('[data-uuid="'+t+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+t+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},s.isActive=function(t){return b?!1:s.tasklist.find('li[data-uuid="'+t+'"]').hasClass("active")};function x(){if(b)return;s.tasklist.find("li").length>0?s.taskbar.attr("data-active","1"):s.taskbar.removeAttr("data-active")}function n(){b||s.tasklist.find(".active").removeClass("active")}function l(t,i){if(b)return i();m.translate(t.options.title,function(a){const r=$("<div></div>").text(a||"NodeBB Task").html(),g=$("<li></li>").addClass(t.options.className).html('<a href="#"'+(t.options.image?` style="background-image: url('`+t.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(t.options.icon?'<i class="fa '+t.options.icon+'"></i> ':"")+'<span aria-label="'+r+'" component="taskbar/title">'+r+"</span></a>").attr({title:r,"data-module":t.module,"data-uuid":t.uuid}).addClass(t.options.state!==void 0?t.options.state:"active");(!t.options.state||t.options.state==="active")&&n(),s.tasklist.append(g),x(),t.element=g,g.data(t),y.fire("action:taskbar.pushed",t),i(g)})}const d=function(t,i,a){switch(i){case"title":t.find('[component="taskbar/title"]').text(a);break;case"icon":t.find("i").attr("class","fa fa-"+a);break;case"image":t.find("a").css("background-image",a?'url("'+a.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":t.find("a").css("background-color",a);break;case"color":t.find("a").css("color",a);break}};return s.update=function(t,i,a){if(b)return;const r=s.tasklist.find('[data-module="'+t+'"][data-uuid="'+i+'"]');if(!r.length)return;const g=r.data();Object.keys(a).forEach(function(v){g[v]=a[v],d(r,v,a[v])}),r.data(g)},s}.apply(C,E),h!==void 0&&(k.exports=h)},36159:(k,C,e)=>{"use strict";var E,h;E=[e(49897),e(40027),e(29930),e(24187),e(81335),e(17459),e(65285)],h=function(m,y,s,b,x,n){const l={};return l.get=d=>m.get(`/topics/${d}/thumbs`,{}),l.getByPid=d=>m.get(`/posts/${d}`,{}).then(t=>l.get(t.tid)),l.delete=(d,t)=>m.del(`/topics/${d}/thumbs`,{path:t}),l.deleteAll=d=>{l.get(d).then(t=>{Promise.all(t.map(i=>l.delete(d,i.url)))})},l.upload=d=>new Promise(t=>{b.show({title:"[[topic:composer.thumb-title]]",method:"put",route:config.relative_path+`/api/v3/topics/${d}/thumbs`},function(i){t(i)})}),l.modal={},l.modal.open=function(d){const{id:t,pid:i}=d;let{modal:a}=d,r;return new Promise(g=>{Promise.all([l.get(t),i?l.getByPid(i):[]]).then(v=>new Promise(S=>{const I=v.reduce((A,P)=>A.concat(P));r=I.length,S(I)})).then(v=>x.render("modals/topic-thumbs",{thumbs:v})).then(v=>{a?n.translate(v,function(S){a.find(".bootbox-body").html(S),l.modal.handleSort({modal:a,numThumbs:r})}):(a=y.dialog({title:"[[modules:thumbs.modal.title]]",message:v,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(l.upload(t).then(()=>{l.modal.open({...d,modal:a}),Promise.all([e.e(54516),e.e(99166),e.e(47061),e.e(49775)]).then(function(){var S=[e(71431)];(I=>{I.updateThumbCount(t,$(`[component="composer"][data-uuid="${t}"]`)),g()}).apply(null,S)}).catch(e.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),l.modal.handleDelete({...d,modal:a}),l.modal.handleSort({modal:a,numThumbs:r}))})})},l.modal.handleDelete=d=>{const t=d.modal.get(0),{id:i}=d;t.addEventListener("click",a=>{a.target.closest('button[data-action="remove"]')&&y.confirm("[[modules:thumbs.modal.confirm-remove]]",r=>{if(!r)return;const g=a.target.closest("[data-id]").getAttribute("data-id"),v=a.target.closest("[data-path]").getAttribute("data-path");m.del(`/topics/${g}/thumbs`,{path:v}).then(()=>{l.modal.open(d),Promise.all([e.e(54516),e.e(99166),e.e(47061),e.e(49775)]).then(function(){var S=[e(71431)];(I=>{I.updateThumbCount(i,$(`[component="composer"][data-uuid="${i}"]`))}).apply(null,S)}).catch(e.oe)}).catch(s.error)})})},l.modal.handleSort=({modal:d,numThumbs:t})=>{if(t>1){const i=d.find(".topic-thumbs-modal");i.sortable({items:"[data-id]"}),i.on("sortupdate",l.modal.handleSortChange)}},l.modal.handleSortChange=(d,t)=>{const i=t.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(i).forEach((a,r)=>{const g=a.getAttribute("data-id");let v=a.getAttribute("data-path");v=v.replace(new RegExp(`^${config.upload_url}`),""),m.put(`/topics/${g}/thumbs/order`,{path:v,order:r}).catch(s.error)})},l}.apply(C,E),h!==void 0&&(k.exports=h)},24187:(k,C,e)=>{"use strict";var E,h;E=[e(64061)],h=function(){const m={};m.show=function(n,l){const d=n.hasOwnProperty("fileSize")&&n.fileSize!==void 0?parseInt(n.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:n.hasOwnProperty("showHelp")&&n.showHelp!==void 0?n.showHelp:!0,fileSize:d,title:n.title||"[[global:upload-file]]",description:n.description||"",button:n.button||"[[global:upload]]",accept:n.accept?n.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show"),t.on("hidden.bs.modal",function(){t.remove()});const i=t.find("#uploadForm");i.attr("action",n.route),i.find("#params").val(JSON.stringify(n.params)),t.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),i.submit()}),i.submit(function(){return y(t,d,l),!1})})},m.hideAlerts=function(n){$(n).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function y(n,l,d){s(n,"status","[[uploads:uploading-file]]"),n.find("#upload-progress-bar").css("width","0%"),n.find("#upload-progress-box").show().removeClass("hide");const t=n.find("#fileInput");if(!t.val())return s(n,"error","[[uploads:select-file-to-upload]]");if(!x(t[0],l))return s(n,"error","[[error:file-too-big, "+l+"]]");m.ajaxSubmit(n,d)}function s(n,l,d){m.hideAlerts(n),l==="error"&&n.find("#fileUploadSubmitBtn").removeClass("disabled"),d=d.replace(/&amp;#44/g,"&#44"),n.find("#alert-"+l).translateText(d).removeClass("hide")}m.ajaxSubmit=function(n,l){n.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(t){t=b(t),s(n,"error",t.responseJSON?.status?.message||t.responseJSON?.error||`[[error:upload-error-fallback, ${t.status} ${t.statusText}]]`)},uploadProgress:function(t,i,a,r){n.find("#upload-progress-bar").css("width",r+"%")},success:function(t){let i=b(t);t.hasOwnProperty("response")&&t.hasOwnProperty("status")&&t.status.code==="ok"&&(i=t.response.images),l(i[0].url),s(n,"success","[[uploads:upload-success]]"),setTimeout(function(){m.hideAlerts(n),n.modal("hide")},750)}})};function b(n){if(typeof n=="string")try{return JSON.parse(n)}catch{return{error:"[[error:parse-error]]"}}return n}function x(n,l){return window.FileReader&&l?n.files[0].size<=l*1e3:!0}return m}.apply(C,E),h!==void 0&&(k.exports=h)},35358:(k,C,e)=>{var E={"./af":25177,"./af.js":25177,"./ar":61509,"./ar-dz":41488,"./ar-dz.js":41488,"./ar-kw":58676,"./ar-kw.js":58676,"./ar-ly":42353,"./ar-ly.js":42353,"./ar-ma":24496,"./ar-ma.js":24496,"./ar-ps":6947,"./ar-ps.js":6947,"./ar-sa":82682,"./ar-sa.js":82682,"./ar-tn":89756,"./ar-tn.js":89756,"./ar.js":61509,"./az":95533,"./az.js":95533,"./be":28959,"./be.js":28959,"./bg":47777,"./bg.js":47777,"./bm":54903,"./bm.js":54903,"./bn":61290,"./bn-bd":17357,"./bn-bd.js":17357,"./bn.js":61290,"./bo":31545,"./bo.js":31545,"./br":89089,"./br.js":89089,"./bs":44429,"./bs.js":44429,"./ca":7306,"./ca.js":7306,"./cs":56464,"./cs.js":56464,"./cv":73635,"./cv.js":73635,"./cy":64226,"./cy.js":64226,"./da":93601,"./da.js":93601,"./de":77853,"./de-at":26111,"./de-at.js":26111,"./de-ch":54697,"./de-ch.js":54697,"./de.js":77853,"./dv":60708,"./dv.js":60708,"./el":54691,"./el.js":54691,"./en-au":53872,"./en-au.js":53872,"./en-ca":28298,"./en-ca.js":28298,"./en-gb":56195,"./en-gb.js":56195,"./en-ie":66584,"./en-ie.js":66584,"./en-il":65543,"./en-il.js":65543,"./en-in":9033,"./en-in.js":9033,"./en-nz":79402,"./en-nz.js":79402,"./en-sg":43004,"./en-sg.js":43004,"./eo":32934,"./eo.js":32934,"./es":97650,"./es-do":20838,"./es-do.js":20838,"./es-mx":17730,"./es-mx.js":17730,"./es-us":56575,"./es-us.js":56575,"./es.js":97650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":119,"./fa.js":119,"./fi":90527,"./fi.js":90527,"./fil":95995,"./fil.js":95995,"./fo":52477,"./fo.js":52477,"./fr":85498,"./fr-ca":26435,"./fr-ca.js":26435,"./fr-ch":37892,"./fr-ch.js":37892,"./fr.js":85498,"./fy":37071,"./fy.js":37071,"./ga":41734,"./ga.js":41734,"./gd":70217,"./gd.js":70217,"./gl":77329,"./gl.js":77329,"./gom-deva":32124,"./gom-deva.js":32124,"./gom-latn":93383,"./gom-latn.js":93383,"./gu":95050,"./gu.js":95050,"./he":11713,"./he.js":11713,"./hi":43861,"./hi.js":43861,"./hr":26308,"./hr.js":26308,"./hu":90609,"./hu.js":90609,"./hy-am":17160,"./hy-am.js":17160,"./id":74063,"./id.js":74063,"./is":89374,"./is.js":89374,"./it":88383,"./it-ch":21827,"./it-ch.js":21827,"./it.js":88383,"./ja":23827,"./ja.js":23827,"./jv":89722,"./jv.js":89722,"./ka":41794,"./ka.js":41794,"./kk":27088,"./kk.js":27088,"./km":96870,"./km.js":96870,"./kn":84451,"./kn.js":84451,"./ko":63164,"./ko.js":63164,"./ku":98174,"./ku-kmr":6181,"./ku-kmr.js":6181,"./ku.js":98174,"./ky":78474,"./ky.js":78474,"./lb":79680,"./lb.js":79680,"./lo":15867,"./lo.js":15867,"./lt":45766,"./lt.js":45766,"./lv":69532,"./lv.js":69532,"./me":58076,"./me.js":58076,"./mi":41848,"./mi.js":41848,"./mk":30306,"./mk.js":30306,"./ml":73739,"./ml.js":73739,"./mn":99053,"./mn.js":99053,"./mr":86169,"./mr.js":86169,"./ms":73386,"./ms-my":92297,"./ms-my.js":92297,"./ms.js":73386,"./mt":77075,"./mt.js":77075,"./my":72264,"./my.js":72264,"./nb":22274,"./nb.js":22274,"./ne":8235,"./ne.js":8235,"./nl":92572,"./nl-be":43784,"./nl-be.js":43784,"./nl.js":92572,"./nn":54566,"./nn.js":54566,"./oc-lnc":69330,"./oc-lnc.js":69330,"./pa-in":29849,"./pa-in.js":29849,"./pl":94418,"./pl.js":94418,"./pt":79834,"./pt-br":48303,"./pt-br.js":48303,"./pt.js":79834,"./ro":24457,"./ro.js":24457,"./ru":82271,"./ru.js":82271,"./sd":1221,"./sd.js":1221,"./se":33478,"./se.js":33478,"./si":17538,"./si.js":17538,"./sk":5784,"./sk.js":5784,"./sl":46637,"./sl.js":46637,"./sq":86794,"./sq.js":86794,"./sr":45719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":45719,"./ss":56e3,"./ss.js":56e3,"./sv":41011,"./sv.js":41011,"./sw":40748,"./sw.js":40748,"./ta":11025,"./ta.js":11025,"./te":11885,"./te.js":11885,"./tet":28861,"./tet.js":28861,"./tg":86571,"./tg.js":86571,"./th":55802,"./th.js":55802,"./tk":59527,"./tk.js":59527,"./tl-ph":29231,"./tl-ph.js":29231,"./tlh":31052,"./tlh.js":31052,"./tr":85096,"./tr.js":85096,"./tzl":79846,"./tzl.js":79846,"./tzm":81765,"./tzm-latn":97711,"./tzm-latn.js":97711,"./tzm.js":81765,"./ug-cn":48414,"./ug-cn.js":48414,"./uk":16618,"./uk.js":16618,"./ur":57777,"./ur.js":57777,"./uz":57609,"./uz-latn":72475,"./uz-latn.js":72475,"./uz.js":57609,"./vi":21135,"./vi.js":21135,"./x-pseudo":64051,"./x-pseudo.js":64051,"./yo":82218,"./yo.js":82218,"./zh-cn":52648,"./zh-cn.js":52648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":31541,"./zh-mo.js":31541,"./zh-tw":50304,"./zh-tw.js":50304};function h(y){var s=m(y);return e(s)}function m(y){if(!e.o(E,y)){var s=new Error("Cannot find module '"+y+"'");throw s.code="MODULE_NOT_FOUND",s}return E[y]}h.keys=function(){return Object.keys(E)},h.resolve=m,k.exports=h,h.id=35358}}]);
