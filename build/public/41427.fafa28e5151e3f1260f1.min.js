"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[41427,61861,99127,34590,13201,98813,68326,87549,34271,1091,25432,15794,92717,87212,33069,49897],{86174:(C,E,l)=>{var g,d;g=[l(19046),l(71949),l(11599),l(29930)],d=function(m,p,a,u){const w={};w.prepareDOM=function(){app.user.uid>0&&m.initUnreadTopics(),p.prepareDOM(),a.prepareDOM(),c(),h(),y()};function c(){$('[component="header/usercontrol"] [data-status]').off("click").on("click",function(n){const o=$(this).attr("data-status");socket.emit("user.setStatus",o,function(i){if(i)return u.error(i);$('[data-uid="'+app.user.uid+'"] [component="user/status"], [component="header/profilelink"] [component="user/status"]').removeClass("away online dnd offline").addClass(o),$('[component="header/usercontrol"] [data-status]').each(function(){$(this).toggleClass("selected",$(this).attr("data-status")===o)}),app.user.status=o}),n.preventDefault()})}function h(){const n=utils.findBootstrapEnvironment();n==="xs"||n==="sm"||utils.isTouchDevice()||$("#header-menu #main-nav").tooltip({selector:".nav-item",placement:"bottom",trigger:"hover",container:"body",animation:!1})}function y(){$("body").on("click",'[component="user/logout"]',function(){return l.e(20739).then(function(){var n=[l(75427)];(function(o){o()}).apply(null,n)}).catch(l.oe),!1})}return w}.apply(E,g),d!==void 0&&(C.exports=d)},11599:(C,E,l)=>{var g,d;g=[l(52473),l(91749),l(49897)],d=function(m,p,a){const u={};u.prepareDOM=function(){const n=$('[component="chat/dropdown"]');n.length&&(n.on("show.bs.dropdown",o=>{y("loadChatsDropdown",$(o.target).parent().find('[component="chat/list"]'))}),n.each((o,i)=>{const t=$(i).parent().find(".dropdown-menu");t.hasClass("show")&&y("loadChatsDropdown",t.find('[component="chat/list"]'))}),socket.removeListener("event:chats.receive",w),socket.on("event:chats.receive",w),socket.removeListener("event:chats.typing",c),socket.on("event:chats.typing",c),socket.removeListener("event:chats.roomRename",h),socket.on("event:chats.roomRename",h),socket.on("event:unread.updateChatCount",async function(o){if(o){const[f,S]=await app.require(["chat","forum/chats"]);if(f.isFromBlockedUser(o.fromUid)||f.isLookingAtRoom(o.roomId)||app.user.uid===parseInt(o.fromUid,10))return;S.markChatPageElUnread(o)}let{count:i}=await a.get("/chats/unread");const t=m.get("chat/icon");i=Math.max(0,i),t.toggleClass("fa-comment",i>0).toggleClass("fa-comment-o",i<=0);const r=i>99?"99+":i;m.get("chat/icon").toggleClass("unread-count",i>0).attr("data-content",r),m.get("chat/count").toggleClass("hidden",i<=0).text(r),p.fire("action:chat.updateCount",{count:i})}))};function w(n){y("onChatMessageReceived",n)}function c(n){y("onUserTyping",n)}function h(n){y("onRoomRename",n)}async function y(n,o){(await app.require("chat"))[n](o)}return u}.apply(E,g),d!==void 0&&(C.exports=d)},71949:(C,E,l)=>{var g;g=function(){const d={};d.prepareDOM=function(){const u=$('[component="notifications"] [data-bs-toggle="dropdown"]');u.length&&(u.on("show.bs.dropdown",w=>{a("loadNotifications",$(w.target).parent().find('[component="notifications/list"]'))}),u.each((w,c)=>{const h=$(c).parent().find(".dropdown-menu");h.hasClass("show")&&a("loadNotifications",h.find('[component="notifications/list"]'))}),socket.removeListener("event:new_notification",m),socket.on("event:new_notification",m),socket.removeListener("event:notifications.updateCount",p),socket.on("event:notifications.updateCount",p))};function m(u){a("onNewNotification",u)}function p(u){a("updateNotifCount",u)}function a(u,w){Promise.all([l.e(65928),l.e(81307)]).then(function(){var c=[l(36849)];(function(h){h[u](w)}).apply(null,c)}).catch(l.oe)}return d}.call(E,l,E,C),g!==void 0&&(C.exports=g)},19046:(C,E,l)=>{var g,d;g=[l(91749)],d=function(m){const p={},a={ignoring:1,notwatching:2,watching:3};p.initUnreadTopics=function(){const c=app.user.unreadData;function h(o){if(o&&o.posts&&o.posts.length&&c){const i=o.posts[0];if(parseInt(i.uid,10)===parseInt(app.user.uid,10)||!i.topic.isFollowing&&i.categoryWatchState!==a.watching)return;const t=i.topic.tid;(!c[""][t]||!c.new[t]||!c.watched[t]||!c.unreplied[t])&&n(t),c[""][t]||(y(""),c[""][t]=!0),i.isMain&&parseInt(i.uid,10)!==parseInt(app.user.uid,10)&&!c.new[t]&&(y("new"),c.new[t]=!0),parseInt(i.topic.postcount,10)<=1&&!c.unreplied[t]&&(y("unreplied"),c.unreplied[t]=!0),i.topic.isFollowing&&!c.watched[t]&&(y("watched"),c.watched[t]=!0)}}function y(o){const i="/unread"+(o?"?filter="+o:""),t=1+parseInt($('a[href="'+config.relative_path+i+'"].navigation-link i').attr("data-content"),10);w(i,t)}function n(o){$('[data-tid="'+o+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(){ajaxify.data.template.topic&&["","new","watched","unreplied"].forEach(function(o){delete c[o][ajaxify.data.tid]})}),socket.removeListener("event:new_post",h),socket.on("event:new_post",h),socket.removeListener("event:unread.updateCount",u),socket.on("event:unread.updateCount",u)};function u(c){w("/unread",c.unreadTopicCount),w("/unread?filter=new",c.unreadNewTopicCount),w("/unread?filter=watched",c.unreadWatchedTopicCount),w("/unread?filter=unreplied",c.unreadUnrepliedTopicCount)}function w(c,h){if(!utils.isNumber(h))return;h=Math.max(0,h);const y=h>99?"99+":h,n=$('a[href="'+config.relative_path+c+'"].navigation-link');n.find("i").toggleClass("unread-count",h>0).attr("data-content",y),n.find('[component="navigation/count"]').toggleClass("hidden",h<=0).text(h),$('#mobile-menu [data-unread-url="'+c+'"]').attr("data-content",y),$('[component="unread/count"][data-unread-url="'+c+'"]').toggleClass("hidden",h<=0).text(y),m.fire("action:unread.updateCount",{url:c,count:h})}return p.updateUnreadTopicCount=w,p}.apply(E,g),d!==void 0&&(C.exports=d)},25967:(C,E,l)=>{var g,d;g=[l(40027)],d=function(m){const p={};return p.init=function(){$("body").on("click",'[component="pagination/select-page"]',function(){return m.prompt("[[global:enter-page-number]]",function(a){p.loadPage(a)}),!1})},p.loadPage=function(a,u){if(u=u||function(){},a=parseInt(a,10),!utils.isNumber(a)||a<1||a>ajaxify.data.pagination.pageCount)return;const w=utils.params();w.page=a;const c=window.location.pathname+"?"+$.param(w);ajaxify.go(c,u)},p.nextPage=function(a){p.loadPage(ajaxify.data.pagination.currentPage+1,a)},p.previousPage=function(a){p.loadPage(ajaxify.data.pagination.currentPage-1,a)},p}.apply(E,g),d!==void 0&&(C.exports=d)},49897:(C,E,l)=>{l.r(E),l.d(E,{del:()=>i,get:()=>c,head:()=>h,patch:()=>n,post:()=>y,put:()=>o});var g=l(91749),d=l.n(g),m=l(40027),p=l.n(m);const a=config.relative_path+"/api/v3";async function u(t,r){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:a+t.url,typeof r=="function"){w(t).then(f=>r(null,f),f=>r(f));return}try{return await w(t)}catch(f){if(f.message==="A valid login session was not found. Please log in and try again."){const{url:S}=await(0,g.fire)("filter:admin.reauth",{url:"login"});return(0,m.confirm)("[[error:api.reauth-required]]",x=>{x&&ajaxify.go(S)})}throw f}}async function w(t){const{url:r}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,g.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const f=await fetch(r,t),{headers:S}=f,x=S.get("content-type"),D=x&&x.startsWith("application/json");let k;if(t.method!=="HEAD"&&(D?k=await f.json():k=await f.text()),!f.ok)throw k?new Error(D?k.status.message:k):new Error(f.statusText);return D&&k&&k.hasOwnProperty("status")&&k.hasOwnProperty("response")?k.response:k}function c(t,r,f){return u({url:t+(r&&Object.keys(r).length?"?"+$.param(r):"")},f)}function h(t,r,f){return u({url:t+(r&&Object.keys(r).length?"?"+$.param(r):""),method:"HEAD"},f)}function y(t,r,f){return u({url:t,method:"POST",data:r,headers:{"x-csrf-token":config.csrf_token}},f)}function n(t,r,f){return u({url:t,method:"PATCH",data:r,headers:{"x-csrf-token":config.csrf_token}},f)}function o(t,r,f){return u({url:t,method:"PUT",data:r,headers:{"x-csrf-token":config.csrf_token}},f)}function i(t,r,f){return u({url:t,method:"DELETE",data:r,headers:{"x-csrf-token":config.csrf_token}},f)}},29869:C=>{C.exports=function(E,l,g){l.setGlobal("true",!0),l.setGlobal("false",!1);const d=24*60*60*1e3,m={displayMenuItem:a,buildMetaTag:u,buildLinkTag:w,stringify:c,escape:h,stripTags:y,buildCategoryIcon:n,buildCategoryLabel:o,generateCategoryBackground:i,generateChildrenCategories:t,generateTopicClass:r,membershipBtn:f,spawnPrivilegeStates:S,localeToHTML:x,renderTopicImage:D,renderDigestAvatar:k,userAgentIcons:A,buildAvatar:P,increment:R,generateWroteReplied:B,generateRepliedTo:T,generateWrote:F,isoTimeToLocaleString:O,shouldHideReplyContainer:j,humanReadableNumber:K,formattedNumber:H,generatePlaceholderWave:z,register:Y,__escape:p};function p(e){return e}function a(e,s){const v=e.navigation[s];return!(!v||v.route.match("/users")&&e.user&&!e.user.privileges["view:users"]||v.route.match("/tags")&&e.user&&!e.user.privileges["view:tags"]||v.route.match("/groups")&&e.user&&!e.user.privileges["view:groups"])}function u(e){const s=e.name?'name="'+e.name+'" ':"",v=e.property?'property="'+e.property+'" ':"",I=e.content?'content="'+e.content.replace(/\n/g," ")+'" ':"";return"<meta "+s+v+I+`/>
	`}function w(e){const s=["link","rel","as","type","href","sizes","title","crossorigin"],[v,I,b,_,N,L,M,W]=s.map(U=>e[U]?`${U}="${e[U]}" `:"");return"<link "+v+I+b+_+L+M+N+W+`/>
	`}function c(e){return JSON.stringify(e).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function h(e){return E.escapeHTML(e)}function y(e){return E.stripHTMLTags(e)}function n(e,s,v){return e?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${v}" style="${i(e)} width:${s}; height: ${s}; font-size: ${parseInt(s,10)/2}px;">${e.icon?`<i class="fa fa-fw ${e.icon}"></i>`:""}</span>`:""}function o(e,s="a",v=""){if(!e)return"";const I=s==="a"?`href="${g}/category/${e.slug}"`:"";return`<${s} ${I} class="badge px-1 text-truncate text-decoration-none ${v}" style="color: ${e.color};background-color: ${e.bgColor};border-color: ${e.bgColor}!important; max-width: 70vw;">
			${e.icon&&e.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${e.icon}"></i>`:""}
			${e.name}
		</${s}>`}function i(e){if(!e)return"";const s=[];return e.bgColor&&(s.push("background-color: "+e.bgColor),s.push(`border-color: ${e.bgColor}!important`)),e.color&&s.push("color: "+e.color),e.backgroundImage&&(s.push("background-image: url("+e.backgroundImage+")"),e.imageClass&&s.push("background-size: "+e.imageClass)),s.join("; ")+";"}function t(e){let s="";return!e||!e.children||!e.children.length||(e.children.forEach(function(v){if(v&&!v.isSection){const I=v.link?v.link:g+"/category/"+v.slug;s+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+i(v)+'"><i class="fa fa-fw '+v.icon+'"></i></div><a href="'+I+'"><small>'+v.name+"</small></a></span>"}}),s=s&&'<span class="category-children">'+s+"</span>"),s}function r(e){return["locked","pinned","deleted","unread","scheduled"].filter(v=>!!e[v]).join(" ")}function f(e,s=""){return e.isMember&&e.name!=="administrators"?`<button class="btn btn-danger ${s}" data-action="leave" data-group="${e.displayName}" ${e.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:e.isPending&&e.name!=="administrators"?`<button class="btn btn-warning disabled ${s}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:e.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${e.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${e.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!e.disableJoinRequests&&e.name!=="administrators"?`<button class="btn btn-success ${s}" data-action="join" data-group="${e.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function S(e,s,v){const I=[];for(const b in s)s.hasOwnProperty(b)&&I.push({name:b,state:s[b],type:v[b]});return I.map(function(b){const _=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],N=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],L=["groups:moderate"],M=e==="guests"&&(_.includes(b.name)||b.name.startsWith("groups:admin:"))||e==="spiders"&&!N.includes(b.name)||e==="Global Moderators"&&L.includes(b.name);return`
				<td data-privilege="${b.name}" data-value="${b.state}" data-type="${b.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none" autocomplete="off" type="checkbox"${b.state?" checked":""}${M?' disabled="disabled"':""} />
					</div>
				</td>
			`}).join("")}function x(e,s){return e=e||s||"en-GB",e.replace("_","-")}function D(e){return e.thumb?'<img src="'+e.thumb+'" class="img-circle user-img" title="'+e.user.username+'" />':'<img component="user/picture" data-uid="'+e.user.uid+'" src="'+e.user.picture+'" class="user-img" title="'+e.user.username+'" />'}function k(e){return e.teaser?e.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.teaser.user.picture+'" title="'+e.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.teaser.user["icon:text"]+"</div>":e.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.user.picture+'" title="'+e.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.user["icon:text"]+"</div>"}function A(e){let s="";switch(e.platform){case"Linux":s+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":s+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":s+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":s+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":s+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":s+='<i class="fa fa-fw fa-mobile"></i>';break;default:s+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(e.browser){case"Chrome":s+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":s+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":s+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":s+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":s+='<i class="fa fa-fw fa-edge"></i>';break;default:s+='<i class="fa fa-fw fa-question-circle"></i>';break}return s}function P(e,s,v,I,b){e||(e=this),I=I||"";const _=new Map([["title",e.username],["data-uid",e.uid],["class",`avatar ${I}${v?" avatar-rounded":""}`]]),N=[`--avatar-size: ${s};`],L=W=>Array.from(W).reduce((U,[q,Q])=>(U+=` ${q}="${Q}"`,U),"");let M="";return e.picture&&(M+=`<img${L(_)} alt="${e.username}" loading="lazy" component="${b||"avatar/picture"}" src="${e.picture}" style="${N.join(" ")}" onError="this.remove()" itemprop="image" />`),M+=`<span${L(_)} component="${b||"avatar/icon"}" style="${N.join(" ")} background-color: ${e["icon:bgColor"]}">${e["icon:text"]}</span>`,M}function R(e,s){return String(e+parseInt(s,10))}function B(e,s){return e.toPid?T(e,s):F(e,s)}function T(e,s){const v=e.parent&&e.parent.displayname?e.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${e.timestamp<Date.now()-s*d?"on":"ago"}, ${e.toPid}, ${g}/post/${e.toPid}, ${v}, ${g}/post/${e.pid}, ${e.timestampISO}]]`}function F(e,s){return`[[topic:wrote-${e.timestamp<Date.now()-s*d?"on":"ago"}, ${g}/post/${e.pid}, ${e.timestampISO}]]`}function O(e,s="en-GB"){return new Date(e).toLocaleString([s],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function j(e){return!!(e.replies.count<=0||e.replies.hasSingleImmediateReply)}function K(e,s=1){return E.makeNumberHumanReadable(e,s)}function H(e){return E.addCommas(e)}function z(e){return e.map(v=>v==="divider"?'<li class="dropdown-divider"></li>':`
			<li class="dropdown-item placeholder-wave">
				<div class="placeholder" style="width: 20px;"></div>
				<div class="placeholder col-${v}"></div>
			</li>`)}function Y(){Object.keys(m).forEach(function(e){l.registerHelper(e,m[e])})}return m}},30076:(C,E,l)=>{var g,d;const m=l(29869);g=[l(77918),l(81335)],d=function(p,a){return m(p,a,config.relative_path)}.apply(E,g),d!==void 0&&(C.exports=d)},10870:(C,E,l)=>{var g,d;g=[l(40027),l(17459),l(68636),l(29930),l(91749)],d=function(m,p,a,u,w){const c={};let h,y;c.show=function(){w.one("action:ajaxify.end",()=>{o(),n(),c.showEmailConfirmWarning()})},c.showEmailConfirmWarning=function(i){if(!config.emailPrompt||!app.user.uid||parseInt(a.getItem("email-confirm-dismiss"),10)===1)return;const t={alert_id:"email_confirm",type:"warning",timeout:0,closefn:()=>{a.setItem("email-confirm-dismiss",1)}};!app.user.email&&!app.user.isEmailConfirmSent?(t.message="[[error:no-email-to-confirm]]",t.clickfn=function(){u.remove("email_confirm"),ajaxify.go("user/"+app.user.userslug+"/edit/email")},u.alert(t)):!app.user["email:confirmed"]&&!app.user.isEmailConfirmSent?(t.message=i||"[[error:email-not-confirmed]]",t.clickfn=function(){u.remove("email_confirm"),ajaxify.go("/me/edit/email")},u.alert(t)):!app.user["email:confirmed"]&&app.user.isEmailConfirmSent&&(t.message="[[error:email-not-confirmed-email-sent]]",u.alert(t))};function n(){!config.cookies.enabled||!navigator.cookieEnabled||app.inAdmin||a.getItem("cookieconsent")==="1"||(config.cookies.message=p.unescape(config.cookies.message),config.cookies.dismiss=p.unescape(config.cookies.dismiss),config.cookies.link=p.unescape(config.cookies.link),config.cookies.link_url=p.unescape(config.cookies.link_url),app.parseAndTranslate("partials/cookie-consent",config.cookies,function(i){$(document.body).append(i),$(document.body).addClass("cookie-consent-open");const t=$(".cookie-consent");t.find("button").on("click",function(){a.setItem("cookieconsent","1"),t.remove(),$(document.body).removeClass("cookie-consent-open")})}))}function o(){const i=utils.params({full:!0});h=i.has("loggedin"),y=i.get("register"),h&&(u.alert({type:"success",title:"[[global:welcome-back]] "+app.user.username+"!",message:"[[global:you-have-successfully-logged-in]]",timeout:5e3}),i.delete("loggedin")),y&&(m.alert({message:utils.escapeHTML(decodeURIComponent(y))}),i.delete("register")),i.has("lang")&&i.get("lang")===config.defaultLang&&(console.info(`The "lang" parameter was passed in to set the language to "${i.get("lang")}", but that is already the forum default language.`),i.delete("lang"));const t=i.toString();ajaxify.updateHistory(ajaxify.currentPage+(t?`?${t}`:"")+document.location.hash,!0)}return c.showInvalidSession=function(){m.alert({title:"[[error:invalid-session]]",message:"[[error:invalid-session-text]]",closeButton:!1,callback:function(){window.location.reload()}})},c.showSessionMismatch=function(){m.alert({title:"[[error:session-mismatch]]",message:"[[error:session-mismatch-text]]",closeButton:!1,callback:function(){window.location.reload()}})},c}.apply(E,g),d!==void 0&&(C.exports=d)},69749:(C,E,l)=>{var g,d;g=[l(17459),l(68636),l(91749),l(29930),l(89336)],d=function(m,p,a,u,w){const c={current:{}};c.init=function(n){if(!config.searchEnabled)return;n=n||{in:config.searchDefaultInQuick||"titles"},$('[component="search/form"]').each((i,t)=>{h($(t),n)})};function h(n,o){const i=n.find('[component="search/button"]'),t=n.find('[component="search/fields"]'),r=t.find('input[name="query"]'),f=t.find("#quick-search-container");t.hasClass("hidden")&&r.off("blur").on("blur",function(){setTimeout(function(){r.is(":focus")||(t.addClass("hidden"),i.removeClass("hidden"))},200)}),r.off("focus");const x={inputEl:r,resultEl:f};c.enableQuickSearch({searchOptions:o,searchElements:x}),i.off("click").on("click",function(D){return!config.loggedIn&&!app.user.privileges["search:content"]?(u.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(D.stopPropagation(),c.showAndFocusInput(n),!1)}),n.off("submit").on("submit",function(){const D=$(this).find('input[name="query"]'),k=c.getSearchPreferences();return k.term=D.val(),k.in=o.in,a.fire("action:search.submit",{searchOptions:k,searchElements:x}),c.query(k,function(){D.val(""),r.trigger("blur")}),!1})}c.enableQuickSearch=function(n){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const o=Object.assign({in:config.searchDefaultInQuick||"titles"},n.searchOptions),i=n.searchElements.resultEl,t=n.searchElements.inputEl;let r=t.val();const f=i.find(".filter-category");function S(){ajaxify.data.template.category&&ajaxify.data.cid&&m.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(A){const P=$("<div></div>").html(A).text();f.find(".name").text(P)}),f.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function x(){n.searchOptions=Object.assign({},o),n.searchOptions.term=t.val(),S(),ajaxify.data.template.category&&ajaxify.data.cid&&f.find('input[type="checkbox"]').is(":checked")&&(n.searchOptions.categories=[ajaxify.data.cid],n.searchOptions.searchChildren=!0),n.hideDuringSearch||(i.removeClass("hidden").find(".quick-search-results-container").html(""),i.find(".loading-indicator").removeClass("hidden")),a.fire("action:search.quick.start",n),n.searchOptions.searchOnly=1,c.api(n.searchOptions,function(A){if(i.find(".loading-indicator").addClass("hidden"),!A.posts||n.hideOnNoMatches&&!A.posts.length)return i.addClass("hidden").find(".quick-search-results-container").html("");A.posts.forEach(function(P){const R=$("<div>"+P.content+"</div>").text(),B=t.val().toLowerCase().replace(/^in:topic-\d+/,""),T=Math.max(0,R.toLowerCase().indexOf(B)-40);P.snippet=utils.escapeHTML((T>0?"...":"")+R.slice(T,T+80)+(R.length-T>80?"...":""))}),A.dropdown={maxWidth:"400px",maxHeight:"500px",...n.dropdown},app.parseAndTranslate("partials/quick-search-results",A,function(P){P.length&&P.find(".timeago").timeago(),i.toggleClass("hidden",!P.length||!t.is(":focus")).find(".quick-search-results-container").html(P.length?P:"");const R=i.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");c.highlightMatches(n.searchOptions.term,R),a.fire("action:search.quick.complete",{data:A,options:n})})})}i.find('.filter-category input[type="checkbox"]').on("change",function(){t.focus(),x()}),t.off("keyup").on("keyup",utils.debounce(function(){if(t.val().length<3){i.addClass("hidden"),r=t.val();return}if(t.val()!==r){if(r=t.val(),!t.is(":focus"))return i.addClass("hidden");x()}},500));let D=!1;i.on("mousedown",".quick-search-results > *",function(){$(window).one("mouseup",function(){i.addClass("hidden")}),D=!0}),t.on("blur",function(){setTimeout(function(){!t.is(":focus")&&!D&&!i.hasClass("hidden")&&i.addClass("hidden")},200)});let k=!1;a.on("action:ajaxify.end",function(){ajaxify.isCold()||(k=!0)}),t.on("focus",function(){D=!1;const A=t.val();r=A,A&&i.find("#quick-search-results").children().length&&(S(),k?(x(),k=!1):i.removeClass("hidden"),t[0].setSelectionRange(A.startsWith("in:topic")?A.indexOf(" ")+1:0,A.length))}),t.off("refresh").on("refresh",function(){x()})},c.showAndFocusInput=function(n){const o=n.parents(".dropdown-menu");if(o.length){const i=o.siblings("[data-bs-toggle]"),t=w.Dropdown.getOrCreateInstance(i[0]);t&&t.show()}else n.find('[component="search/fields"]').removeClass("hidden"),n.find('[component="search/button"]').addClass("hidden"),n.find('[component="search/fields"] input[name="query"]').trigger("focus")},c.query=function(n,o){o=o||function(){},ajaxify.go("search?"+y(n),o)},c.api=function(n,o){const i=config.relative_path+"/api/search?"+y(n);n.hasOwnProperty("searchOnly")&&delete n.searchOnly;const t=config.relative_path+"/search?"+y(n);$.get(i,function(r){r.url=t,o(r)})};function y(n){const o=n.in||"titles";let i=n.term.replace(/^[ ?#]*/,"");try{i=encodeURIComponent(i)}catch{return u.error("[[error:invalid-search-term]]")}const t={...n,term:i,in:o};return a.fire("action:search.createQueryString",{query:t,data:n}),decodeURIComponent($.param(t))}return c.getSearchPreferences=function(){try{return JSON.parse(p.getItem("search-preferences")||"{}")}catch{return{}}},c.highlightMatches=function(n,o){if(!n||!o.length)return;n=utils.escapeHTML(n.replace(/^"/,"").replace(/"$/,"").trim());const i=n.split(" ").filter(r=>r.length>1).map(function(r){return utils.escapeRegexChars(r)}).join("|"),t=new RegExp("("+i+")","gi");o.each(function(){const r=$(this),f=[];r.find("*").each(function(){$(this).after("<!-- "+f.length+" -->"),f.push($("<div></div>").append($(this)))}),r.html(r.html().replace(t,function(S,x){return'<strong class="search-match fw-bold text-decoration-underline">'+x+"</strong>"})),f.forEach(function(S,x){r.html(r.html().replace("<!-- "+x+" -->",function(){return S.html()}))})}),$(".search-result-text").find("img:not(.not-responsive)").addClass("img-fluid")},c}.apply(E,g),d!==void 0&&(C.exports=d)},68636:(C,E,l)=>{var g;g=function(){function d(){this._store={},this._keys=[]}d.prototype.isMock=!0,d.prototype.setItem=function(a,u){a=String(a),this._keys.indexOf(a)===-1&&this._keys.push(a),this._store[a]=u},d.prototype.getItem=function(a){return a=String(a),this._keys.indexOf(a)===-1?null:this._store[a]},d.prototype.removeItem=function(a){a=String(a),this._keys=this._keys.filter(function(u){return u!==a}),this._store[a]=null},d.prototype.clear=function(){this._keys=[],this._store={}},d.prototype.key=function(a){return a=parseInt(a,10)||0,this._keys[a]},Object.defineProperty&&Object.defineProperty(d.prototype,"length",{get:function(){return this._keys.length}});let m;const p=Date.now().toString();try{if(m=window.localStorage,m.setItem(p,p),m.getItem(p)!==p)throw Error("localStorage behaved unexpectedly");return m.removeItem(p),m}catch(a){console.warn(a),console.warn("localStorage failed, falling back on sessionStorage");try{if(m=window.sessionStorage,m.setItem(p,p),m.getItem(p)!==p)throw Error("sessionStorage behaved unexpectedly");return m.removeItem(p),m}catch(u){return console.warn(u),console.warn("sessionStorage failed, falling back on memory storage"),new d}}}.call(E,l,E,C),g!==void 0&&(C.exports=g)},14063:(C,E,l)=>{C=l.nmd(C);var g,d;g=[l(17459),l(91749)],d=function(m,p){const a={};let u=!1;a.init=function(){if(a.taskbar=$('[component="taskbar"]'),a.tasklist=a.taskbar.find("ul"),!a.taskbar.length||!a.tasklist.length){u=!0;return}a.taskbar.on("click","li",async function(){const n=$(this),o=n.attr("data-module"),i=n.attr("data-uuid"),t=await app.require(o);return n.hasClass("active")?t.minimize(i):(c(),t.load(i),a.toggleNew(i,!1),a.tasklist.removeClass("active"),n.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){a.closeAll()})},a.close=async function(n,o){if(u)return;if(a.tasklist.find('[data-module="'+C+'"][data-uuid="'+o+'"]').length){const t=await app.require(n);t&&typeof t.close=="function"&&t.close(o)}},a.closeAll=function(n){if(u)return;let o="[data-uuid]";n&&(o='[data-module="'+n+'"]'+o),a.tasklist.find(o).each(function(i,t){a.close(n||t.getAttribute("data-module"),t.getAttribute("data-uuid"))})},a.discard=function(n,o){if(u)return;a.tasklist.find('[data-module="'+n+'"][data-uuid="'+o+'"]').remove(),w()},a.push=function(n,o,i,t){if(t=t||function(){},u)return t();const r=a.tasklist.find('li[data-uuid="'+o+'"]'),f={module:n,uuid:o,options:i,element:r};p.fire("filter:taskbar.push",f),!r.length&&f.module?h(f,t):t(r)},a.get=function(n){return u?[]:$('[data-module="'+n+'"]').map(function(i,t){return $(t).data()})},a.minimize=function(n,o){if(u)return;a.tasklist.find('[data-module="'+n+'"][data-uuid="'+o+'"]').toggleClass("active",!1)},a.toggleNew=function(n,o,i){if(u)return;a.tasklist.find('[data-uuid="'+n+'"]').toggleClass("new",o),i||p.fire("action:taskbar.toggleNew",n)},a.updateActive=function(n){if(u)return;const o=a.tasklist.find("li");o.removeClass("active"),o.filter('[data-uuid="'+n+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+n+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},a.isActive=function(n){return u?!1:a.tasklist.find('li[data-uuid="'+n+'"]').hasClass("active")};function w(){if(u)return;a.tasklist.find("li").length>0?a.taskbar.attr("data-active","1"):a.taskbar.removeAttr("data-active")}function c(){u||a.tasklist.find(".active").removeClass("active")}function h(n,o){if(u)return o();m.translate(n.options.title,function(i){const t=$("<div></div>").text(i||"NodeBB Task").html(),r=$("<li></li>").addClass(n.options.className).html('<a href="#"'+(n.options.image?` style="background-image: url('`+n.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(n.options.icon?'<i class="fa '+n.options.icon+'"></i> ':"")+'<span aria-label="'+t+'" component="taskbar/title">'+t+"</span></a>").attr({title:t,"data-module":n.module,"data-uuid":n.uuid}).addClass(n.options.state!==void 0?n.options.state:"active");(!n.options.state||n.options.state==="active")&&c(),a.tasklist.append(r),w(),n.element=r,r.data(n),p.fire("action:taskbar.pushed",n),o(r)})}const y=function(n,o,i){switch(o){case"title":n.find('[component="taskbar/title"]').text(i);break;case"icon":n.find("i").attr("class","fa fa-"+i);break;case"image":n.find("a").css("background-image",i?'url("'+i.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":n.find("a").css("background-color",i);break;case"color":n.find("a").css("color",i);break}};return a.update=function(n,o,i){if(u)return;const t=a.tasklist.find('[data-module="'+n+'"][data-uuid="'+o+'"]');if(!t.length)return;const r=t.data();Object.keys(i).forEach(function(f){r[f]=i[f],y(t,f,i[f])}),t.data(r)},a}.apply(E,g),d!==void 0&&(C.exports=d)}}]);
