(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[23781,99127,34271,1091,46379,92332,88189,6232,18732,25432,15794,26174,87212,33069,62441,98463,49897,29567,49775,11484,23346],{49897:(y,w,a)=>{"use strict";a.r(w),a.d(w,{del:()=>r,get:()=>u,head:()=>m,patch:()=>e,post:()=>g,put:()=>t});var p=a(91749),v=a.n(p),h=a(40027),d=a.n(h);const i=config.relative_path+"/api/v3";async function c(o,s){if(o.url=o.url.startsWith("/api")?config.relative_path+o.url:i+o.url,typeof s=="function"){b(o).then(l=>s(null,l),l=>s(l));return}try{return await b(o)}catch(l){if(l.message==="A valid login session was not found. Please log in and try again."){const{url:x}=await(0,p.fire)("filter:admin.reauth",{url:"login"});return(0,h.confirm)("[[error:api.reauth-required]]",S=>{S&&ajaxify.go(x)})}throw l}}async function b(o){const{url:s}=o;delete o.url,o.data&&!(o.data instanceof FormData)&&(o.data=JSON.stringify(o.data||{}),o.headers["content-type"]="application/json; charset=utf-8"),{options:o}=await(0,p.fire)("filter:api.options",{options:o}),o.data&&(o.body=o.data,delete o.data);const l=await fetch(s,o),{headers:x}=l,S=x.get("content-type"),F=S&&S.startsWith("application/json");let E;if(o.method!=="HEAD"&&(F?E=await l.json():E=await l.text()),!l.ok)throw E?new Error(F?E.status.message:E):new Error(l.statusText);return F&&E&&E.hasOwnProperty("status")&&E.hasOwnProperty("response")?E.response:E}function u(o,s,l){return c({url:o+(s&&Object.keys(s).length?"?"+$.param(s):"")},l)}function m(o,s,l){return c({url:o+(s&&Object.keys(s).length?"?"+$.param(s):""),method:"HEAD"},l)}function g(o,s,l){return c({url:o,method:"POST",data:s,headers:{"x-csrf-token":config.csrf_token}},l)}function e(o,s,l){return c({url:o,method:"PATCH",data:s,headers:{"x-csrf-token":config.csrf_token}},l)}function t(o,s,l){return c({url:o,method:"PUT",data:s,headers:{"x-csrf-token":config.csrf_token}},l)}function r(o,s,l){return c({url:o,method:"DELETE",data:s,headers:{"x-csrf-token":config.csrf_token}},l)}},74566:(y,w,a)=>{y.exports=a(12236)},449:(y,w,a)=>{y.exports=a(91943)},89596:(y,w,a)=>{y.exports=a(62590)},99594:(y,w,a)=>{y.exports=a(57904)},29869:y=>{"use strict";y.exports=function(w,a,p){a.setGlobal("true",!0),a.setGlobal("false",!1);const v=24*60*60*1e3,h={displayMenuItem:i,buildMetaTag:c,buildLinkTag:b,stringify:u,escape:m,stripTags:g,buildCategoryIcon:e,buildCategoryLabel:t,generateCategoryBackground:r,generateChildrenCategories:o,generateTopicClass:s,membershipBtn:l,spawnPrivilegeStates:x,localeToHTML:S,renderTopicImage:F,renderDigestAvatar:E,userAgentIcons:D,buildAvatar:I,increment:k,generateWroteReplied:O,generateRepliedTo:W,generateWrote:z,isoTimeToLocaleString:N,shouldHideReplyContainer:L,humanReadableNumber:H,formattedNumber:P,generatePlaceholderWave:B,register:T,__escape:d};function d(n){return n}function i(n,f){const A=n.navigation[f];return!(!A||A.route.match("/users")&&n.user&&!n.user.privileges["view:users"]||A.route.match("/tags")&&n.user&&!n.user.privileges["view:tags"]||A.route.match("/groups")&&n.user&&!n.user.privileges["view:groups"])}function c(n){const f=n.name?'name="'+n.name+'" ':"",A=n.property?'property="'+n.property+'" ':"",R=n.content?'content="'+n.content.replace(/\n/g," ")+'" ':"";return"<meta "+f+A+R+`/>
	`}function b(n){const f=["link","rel","as","type","href","sizes","title","crossorigin"],[A,R,C,K,U,Y,M,j]=f.map(J=>n[J]?`${J}="${n[J]}" `:"");return"<link "+A+R+C+K+Y+M+U+j+`/>
	`}function u(n){return JSON.stringify(n).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function m(n){return w.escapeHTML(n)}function g(n){return w.stripHTMLTags(n)}function e(n,f,A){return n?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${A}" style="${r(n)} width:${f}; height: ${f}; font-size: ${parseInt(f,10)/2}px;">${n.icon?`<i class="fa fa-fw ${n.icon}"></i>`:""}</span>`:""}function t(n,f="a",A=""){if(!n)return"";const R=f==="a"?`href="${p}/category/${n.slug}"`:"";return`<${f} ${R} class="badge px-1 text-truncate text-decoration-none ${A}" style="color: ${n.color};background-color: ${n.bgColor};border-color: ${n.bgColor}!important; max-width: 70vw;">
			${n.icon&&n.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${n.icon}"></i>`:""}
			${n.name}
		</${f}>`}function r(n){if(!n)return"";const f=[];return n.bgColor&&(f.push("background-color: "+n.bgColor),f.push(`border-color: ${n.bgColor}!important`)),n.color&&f.push("color: "+n.color),n.backgroundImage&&(f.push("background-image: url("+n.backgroundImage+")"),n.imageClass&&f.push("background-size: "+n.imageClass)),f.join("; ")+";"}function o(n){let f="";return!n||!n.children||!n.children.length||(n.children.forEach(function(A){if(A&&!A.isSection){const R=A.link?A.link:p+"/category/"+A.slug;f+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+r(A)+'"><i class="fa fa-fw '+A.icon+'"></i></div><a href="'+R+'"><small>'+A.name+"</small></a></span>"}}),f=f&&'<span class="category-children">'+f+"</span>"),f}function s(n){return["locked","pinned","deleted","unread","scheduled"].filter(A=>!!n[A]).join(" ")}function l(n,f=""){return n.isMember&&n.name!=="administrators"?`<button class="btn btn-danger ${f}" data-action="leave" data-group="${n.displayName}" ${n.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:n.isPending&&n.name!=="administrators"?`<button class="btn btn-warning disabled ${f}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:n.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${n.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${n.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!n.disableJoinRequests&&n.name!=="administrators"?`<button class="btn btn-success ${f}" data-action="join" data-group="${n.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function x(n,f,A){const R=[];for(const C in f)f.hasOwnProperty(C)&&R.push({name:C,state:f[C],type:A[C]});return R.map(function(C){const K=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],U=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],Y=["groups:moderate"],M=n==="guests"&&(K.includes(C.name)||C.name.startsWith("groups:admin:"))||n==="spiders"&&!U.includes(C.name)||n==="Global Moderators"&&Y.includes(C.name);return`
				<td data-privilege="${C.name}" data-value="${C.state}" data-type="${C.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none" autocomplete="off" type="checkbox"${C.state?" checked":""}${M?' disabled="disabled"':""} />
					</div>
				</td>
			`}).join("")}function S(n,f){return n=n||f||"en-GB",n.replace("_","-")}function F(n){return n.thumb?'<img src="'+n.thumb+'" class="img-circle user-img" title="'+n.user.username+'" />':'<img component="user/picture" data-uid="'+n.user.uid+'" src="'+n.user.picture+'" class="user-img" title="'+n.user.username+'" />'}function E(n){return n.teaser?n.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+n.teaser.user.picture+'" title="'+n.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+n.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+n.teaser.user["icon:text"]+"</div>":n.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+n.user.picture+'" title="'+n.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+n.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+n.user["icon:text"]+"</div>"}function D(n){let f="";switch(n.platform){case"Linux":f+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":f+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":f+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":f+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":f+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":f+='<i class="fa fa-fw fa-mobile"></i>';break;default:f+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(n.browser){case"Chrome":f+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":f+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":f+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":f+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":f+='<i class="fa fa-fw fa-edge"></i>';break;default:f+='<i class="fa fa-fw fa-question-circle"></i>';break}return f}function I(n,f,A,R,C){n||(n=this),R=R||"";const K=new Map([["title",n.username],["data-uid",n.uid],["class",`avatar ${R}${A?" avatar-rounded":""}`]]),U=[`--avatar-size: ${f};`],Y=j=>Array.from(j).reduce((J,[G,Q])=>(J+=` ${G}="${Q}"`,J),"");let M="";return n.picture&&(M+=`<img${Y(K)} alt="${n.username}" loading="lazy" component="${C||"avatar/picture"}" src="${n.picture}" style="${U.join(" ")}" onError="this.remove()" itemprop="image" />`),M+=`<span${Y(K)} component="${C||"avatar/icon"}" style="${U.join(" ")} background-color: ${n["icon:bgColor"]}">${n["icon:text"]}</span>`,M}function k(n,f){return String(n+parseInt(f,10))}function O(n,f){return n.toPid?W(n,f):z(n,f)}function W(n,f){const A=n.parent&&n.parent.displayname?n.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${n.timestamp<Date.now()-f*v?"on":"ago"}, ${n.toPid}, ${p}/post/${n.toPid}, ${A}, ${p}/post/${n.pid}, ${n.timestampISO}]]`}function z(n,f){return`[[topic:wrote-${n.timestamp<Date.now()-f*v?"on":"ago"}, ${p}/post/${n.pid}, ${n.timestampISO}]]`}function N(n,f="en-GB"){return new Date(n).toLocaleString([f],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function L(n){return!!(n.replies.count<=0||n.replies.hasSingleImmediateReply)}function H(n,f=1){return w.makeNumberHumanReadable(n,f)}function P(n){return w.addCommas(n)}function B(n){return n.map(A=>A==="divider"?'<li class="dropdown-divider"></li>':`
			<li class="dropdown-item placeholder-wave">
				<div class="placeholder" style="width: 20px;"></div>
				<div class="placeholder col-${A}"></div>
			</li>`)}function T(){Object.keys(h).forEach(function(n){a.registerHelper(n,h[n])})}return h}},30076:(y,w,a)=>{"use strict";var p,v;const h=a(29869);p=[a(77918),a(81335)],v=function(d,i){return h(d,i,config.relative_path)}.apply(w,p),v!==void 0&&(y.exports=v)},13230:(y,w,a)=>{"use strict";var p,v,h;(function(d){v=[a(53050)],p=d,h=typeof p=="function"?p.apply(w,v):p,h!==void 0&&(y.exports=h)})(function(d){const i=d("[^\\p{L}\\s\\d\\-_]","g"),c=/[^\w\s\d\-_]/g,b=/^\s+|\s+$/g,u=/\s+/g,m=/-+/g,g=/-$/g,e=/^-/g,t=/^[\w\d\s.,\-@]+$/;return function(o,s){return o?(o=String(o).replace(b,""),t.test(o)?o=o.replace(c,"-"):o=d.replace(o,i,"-"),o=s?o:o.toLocaleLowerCase(),o=o.replace(u,"-"),o=o.replace(m,"-"),o=o.replace(g,""),o=o.replace(e,""),o):""}})},68636:(y,w,a)=>{"use strict";var p;p=function(){function v(){this._store={},this._keys=[]}v.prototype.isMock=!0,v.prototype.setItem=function(i,c){i=String(i),this._keys.indexOf(i)===-1&&this._keys.push(i),this._store[i]=c},v.prototype.getItem=function(i){return i=String(i),this._keys.indexOf(i)===-1?null:this._store[i]},v.prototype.removeItem=function(i){i=String(i),this._keys=this._keys.filter(function(c){return c!==i}),this._store[i]=null},v.prototype.clear=function(){this._keys=[],this._store={}},v.prototype.key=function(i){return i=parseInt(i,10)||0,this._keys[i]},Object.defineProperty&&Object.defineProperty(v.prototype,"length",{get:function(){return this._keys.length}});let h;const d=Date.now().toString();try{if(h=window.localStorage,h.setItem(d,d),h.getItem(d)!==d)throw Error("localStorage behaved unexpectedly");return h.removeItem(d),h}catch(i){console.warn(i),console.warn("localStorage failed, falling back on sessionStorage");try{if(h=window.sessionStorage,h.setItem(d,d),h.getItem(d)!==d)throw Error("sessionStorage behaved unexpectedly");return h.removeItem(d),h}catch(c){return console.warn(c),console.warn("sessionStorage failed, falling back on memory storage"),new v}}}.call(w,a,w,y),p!==void 0&&(y.exports=p)},14063:(y,w,a)=>{"use strict";y=a.nmd(y);var p,v;p=[a(17459),a(91749)],v=function(h,d){const i={};let c=!1;i.init=function(){if(i.taskbar=$('[component="taskbar"]'),i.tasklist=i.taskbar.find("ul"),!i.taskbar.length||!i.tasklist.length){c=!0;return}i.taskbar.on("click","li",async function(){const e=$(this),t=e.attr("data-module"),r=e.attr("data-uuid"),o=await app.require(t);return e.hasClass("active")?o.minimize(r):(u(),o.load(r),i.toggleNew(r,!1),i.tasklist.removeClass("active"),e.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){i.closeAll()})},i.close=async function(e,t){if(c)return;if(i.tasklist.find('[data-module="'+y+'"][data-uuid="'+t+'"]').length){const o=await app.require(e);o&&typeof o.close=="function"&&o.close(t)}},i.closeAll=function(e){if(c)return;let t="[data-uuid]";e&&(t='[data-module="'+e+'"]'+t),i.tasklist.find(t).each(function(r,o){i.close(e||o.getAttribute("data-module"),o.getAttribute("data-uuid"))})},i.discard=function(e,t){if(c)return;i.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]').remove(),b()},i.push=function(e,t,r,o){if(o=o||function(){},c)return o();const s=i.tasklist.find('li[data-uuid="'+t+'"]'),l={module:e,uuid:t,options:r,element:s};d.fire("filter:taskbar.push",l),!s.length&&l.module?m(l,o):o(s)},i.get=function(e){return c?[]:$('[data-module="'+e+'"]').map(function(r,o){return $(o).data()})},i.minimize=function(e,t){if(c)return;i.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]').toggleClass("active",!1)},i.toggleNew=function(e,t,r){if(c)return;i.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",t),r||d.fire("action:taskbar.toggleNew",e)},i.updateActive=function(e){if(c)return;const t=i.tasklist.find("li");t.removeClass("active"),t.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},i.isActive=function(e){return c?!1:i.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function b(){if(c)return;i.tasklist.find("li").length>0?i.taskbar.attr("data-active","1"):i.taskbar.removeAttr("data-active")}function u(){c||i.tasklist.find(".active").removeClass("active")}function m(e,t){if(c)return t();h.translate(e.options.title,function(r){const o=$("<div></div>").text(r||"NodeBB Task").html(),s=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+o+'" component="taskbar/title">'+o+"</span></a>").attr({title:o,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&u(),i.tasklist.append(s),b(),e.element=s,s.data(e),d.fire("action:taskbar.pushed",e),t(s)})}const g=function(e,t,r){switch(t){case"title":e.find('[component="taskbar/title"]').text(r);break;case"icon":e.find("i").attr("class","fa fa-"+r);break;case"image":e.find("a").css("background-image",r?'url("'+r.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",r);break;case"color":e.find("a").css("color",r);break}};return i.update=function(e,t,r){if(c)return;const o=i.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]');if(!o.length)return;const s=o.data();Object.keys(r).forEach(function(l){s[l]=r[l],g(o,l,r[l])}),o.data(s)},i}.apply(w,p),v!==void 0&&(y.exports=v)},36159:(y,w,a)=>{"use strict";var p,v;p=[a(49897),a(40027),a(29930),a(24187),a(81335),a(17459),a(65285)],v=function(h,d,i,c,b,u){const m={};return m.get=g=>h.get(`/topics/${g}/thumbs`,{}),m.getByPid=g=>h.get(`/posts/${g}`,{}).then(e=>m.get(e.tid)),m.delete=(g,e)=>h.del(`/topics/${g}/thumbs`,{path:e}),m.deleteAll=g=>{m.get(g).then(e=>{Promise.all(e.map(t=>m.delete(g,t.url)))})},m.upload=g=>new Promise(e=>{c.show({title:"[[topic:composer.thumb-title]]",method:"put",route:config.relative_path+`/api/v3/topics/${g}/thumbs`},function(t){e(t)})}),m.modal={},m.modal.open=function(g){const{id:e,pid:t}=g;let{modal:r}=g,o;return new Promise(s=>{Promise.all([m.get(e),t?m.getByPid(t):[]]).then(l=>new Promise(x=>{const S=l.reduce((F,E)=>F.concat(E));o=S.length,x(S)})).then(l=>b.render("modals/topic-thumbs",{thumbs:l})).then(l=>{r?u.translate(l,function(x){r.find(".bootbox-body").html(x),m.modal.handleSort({modal:r,numThumbs:o})}):(r=d.dialog({title:"[[modules:thumbs.modal.title]]",message:l,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(m.upload(e).then(()=>{m.modal.open({...g,modal:r}),Promise.all([a.e(54516),a.e(99166),a.e(47061),a.e(49775)]).then(function(){var x=[a(71431)];(S=>{S.updateThumbCount(e,$(`[component="composer"][data-uuid="${e}"]`)),s()}).apply(null,x)}).catch(a.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),m.modal.handleDelete({...g,modal:r}),m.modal.handleSort({modal:r,numThumbs:o}))})})},m.modal.handleDelete=g=>{const e=g.modal.get(0),{id:t}=g;e.addEventListener("click",r=>{r.target.closest('button[data-action="remove"]')&&d.confirm("[[modules:thumbs.modal.confirm-remove]]",o=>{if(!o)return;const s=r.target.closest("[data-id]").getAttribute("data-id"),l=r.target.closest("[data-path]").getAttribute("data-path");h.del(`/topics/${s}/thumbs`,{path:l}).then(()=>{m.modal.open(g),Promise.all([a.e(54516),a.e(99166),a.e(47061),a.e(49775)]).then(function(){var x=[a(71431)];(S=>{S.updateThumbCount(t,$(`[component="composer"][data-uuid="${t}"]`))}).apply(null,x)}).catch(a.oe)}).catch(i.error)})})},m.modal.handleSort=({modal:g,numThumbs:e})=>{if(e>1){const t=g.find(".topic-thumbs-modal");t.sortable({items:"[data-id]"}),t.on("sortupdate",m.modal.handleSortChange)}},m.modal.handleSortChange=(g,e)=>{const t=e.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(t).forEach((r,o)=>{const s=r.getAttribute("data-id");let l=r.getAttribute("data-path");l=l.replace(new RegExp(`^${config.upload_url}`),""),h.put(`/topics/${s}/thumbs/order`,{path:l,order:o}).catch(i.error)})},m}.apply(w,p),v!==void 0&&(y.exports=v)},24187:(y,w,a)=>{"use strict";var p,v;p=[a(64061)],v=function(){const h={};h.show=function(u,m){const g=u.hasOwnProperty("fileSize")&&u.fileSize!==void 0?parseInt(u.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:u.hasOwnProperty("showHelp")&&u.showHelp!==void 0?u.showHelp:!0,fileSize:g,title:u.title||"[[global:upload-file]]",description:u.description||"",button:u.button||"[[global:upload]]",accept:u.accept?u.accept.replace(/,/g,"&#44; "):""},function(e){e.modal("show"),e.on("hidden.bs.modal",function(){e.remove()});const t=e.find("#uploadForm");t.attr("action",u.route),t.find("#params").val(JSON.stringify(u.params)),e.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),t.submit()}),t.submit(function(){return d(e,g,m),!1})})},h.hideAlerts=function(u){$(u).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function d(u,m,g){i(u,"status","[[uploads:uploading-file]]"),u.find("#upload-progress-bar").css("width","0%"),u.find("#upload-progress-box").show().removeClass("hide");const e=u.find("#fileInput");if(!e.val())return i(u,"error","[[uploads:select-file-to-upload]]");if(!b(e[0],m))return i(u,"error","[[error:file-too-big, "+m+"]]");h.ajaxSubmit(u,g)}function i(u,m,g){h.hideAlerts(u),m==="error"&&u.find("#fileUploadSubmitBtn").removeClass("disabled"),g=g.replace(/&amp;#44/g,"&#44"),u.find("#alert-"+m).translateText(g).removeClass("hide")}h.ajaxSubmit=function(u,m){u.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=c(e),i(u,"error",e.responseJSON?.status?.message||e.responseJSON?.error||`[[error:upload-error-fallback, ${e.status} ${e.statusText}]]`)},uploadProgress:function(e,t,r,o){u.find("#upload-progress-bar").css("width",o+"%")},success:function(e){let t=c(e);e.hasOwnProperty("response")&&e.hasOwnProperty("status")&&e.status.code==="ok"&&(t=e.response.images),m(t[0].url),i(u,"success","[[uploads:upload-success]]"),setTimeout(function(){h.hideAlerts(u),u.modal("hide")},750)}})};function c(u){if(typeof u=="string")try{return JSON.parse(u)}catch{return{error:"[[error:parse-error]]"}}return u}function b(u,m){return window.FileReader&&m?u.files[0].size<=m*1e3:!0}return h}.apply(w,p),v!==void 0&&(y.exports=v)},12236:(y,w,a)=>{"use strict";var p,v;p=[a(49897),a(29930)],v=function(h,d){const i={};i.init=function(e,t){const r=e.find(".draft-icon"),o=e.attr("data-uuid");function s(){$(`[component="composer"][data-uuid="${o}"]`).length&&(t.save_id||(t.save_id=utils.generateSaveId(app.user.uid)),i.addToDraftList("available",t.save_id),i.addToDraftList("open",t.save_id),u(e,r,t))}e.on("keyup","textarea, input.handle, input.title",utils.debounce(s,1e3)),e.on("click",'input[type="checkbox"]',utils.debounce(s,1e3)),e.on("click",'[component="category/list"] [data-cid]',utils.debounce(s,1e3)),e.on("itemAdded",".tags",utils.debounce(s,1e3)),e.on("thumb.uploaded",s),r.on("animationend",function(){$(this).toggleClass("active",!1)}),$(window).on("unload",function(){const l=i.getList("open");l.length&&l.forEach(x=>i.removeFromDraftList("open",x))}),i.migrateGuest(),i.migrateThumbs(...arguments)};function b(e){return parseInt(e,10)>0?localStorage:sessionStorage}i.get=function(e){if(!e)return null;const t=e.split(":")[1],r=b(t);try{const o=r.getItem(e),s=JSON.parse(o)||null;if(!s)throw new Error(`can't parse draft json for ${e}`);return s.save_id=e,s.timestamp&&(s.timestampISO=utils.toISOString(s.timestamp)),$(window).trigger("action:composer.drafts.get",{save_id:e,draft:s,storage:r}),s}catch{return console.warn(`[composer/drafts] Could not get draft ${e}, removing`),i.removeFromDraftList("available"),i.removeFromDraftList("open"),null}};function u(e,t,r){if(g(app.user.uid?"localStorage":"sessionStorage")&&r&&r.save_id&&e.length){const o=e.find("input.title"),s=o&&o.length&&o.val(),l=e.find("textarea").val(),x=b(app.user.uid);if(l.length||s&&s.length){const S={save_id:r.save_id,action:r.action,text:l,uuid:e.attr("data-uuid"),timestamp:Date.now()};if(r.action==="topics.post"){const F=e.find("input.tags").val();S.tags=F,S.title=s,S.cid=r.cid}else r.action==="posts.reply"?(S.title=r.title,S.tid=r.tid,S.toPid=r.toPid):r.action==="posts.edit"&&(S.pid=r.pid,S.title=s||r.title);app.user.uid||(S.handle=e.find("input.handle").val()),x.setItem(r.save_id,JSON.stringify(S)),$(window).trigger("action:composer.drafts.save",{storage:x,postData:r,postContainer:e}),t.toggleClass("active",!0)}else i.removeDraft(r.save_id)}}i.removeDraft=function(e){if(!e)return;i.removeFromDraftList("available",e),i.removeFromDraftList("open",e);const t=e.split(":")[1],r=b(t);r.removeItem(e),$(window).trigger("action:composer.drafts.remove",{storage:r,save_id:e})},i.getList=function(e){try{const t=localStorage.getItem(`drafts:${e}`);return JSON.parse(t)||[]}catch{return console.warn("[composer/drafts] Could not read list of available drafts"),[]}},i.addToDraftList=function(e,t){if(!g(app.user.uid?"localStorage":"sessionStorage")||!t)return;const r=i.getList(e);r.includes(t)||(r.push(t),localStorage.setItem("drafts:"+e,JSON.stringify(r)))},i.removeFromDraftList=function(e,t){if(!g(app.user.uid?"localStorage":"sessionStorage")||!t)return;const r=i.getList(e);r.includes(t)&&(r.splice(r.indexOf(t),1),localStorage.setItem("drafts:"+e,JSON.stringify(r)))},i.migrateGuest=function(){if(g("localStorage")&&app.user.uid){const e=/^composer:\d+:\d$/,t=Object.keys(sessionStorage).filter(function(s){return e.test(s)}),r=new Set([]),o=t.map(function(s){const l=s.split(":");return l[1]=app.user.uid,r.add(l.join(":")),l.join(":")});return t.forEach(function(s,l){localStorage.setItem(o[l],sessionStorage.getItem(s)),sessionStorage.removeItem(s)}),r.forEach(function(s){i.addToDraftList("available",s)}),r}},i.migrateThumbs=function(e,t){if(!app.uid)return;const r=e.attr("data-uuid"),o=i.get(t.save_id);o&&o.uuid&&h.put(`/topics/${o.uuid}/thumbs`,{tid:r}).then(()=>{Promise.all([a.e(23662),a.e(65285),a.e(54516),a.e(99166),a.e(47061),a.e(11484)]).then(function(){var s=[a(71431)];(function(l){l.updateThumbCount(r,e)}).apply(null,s)}).catch(a.oe)})},i.listAvailable=function(){return i.getList("available").map(i.get).filter(Boolean)},i.getAvailableCount=function(){return i.listAvailable().length},i.open=function(e){if(!e)return;const t=i.get(e);m(e,t)},i.loadOpen=function(){if(ajaxify.data.template.login||ajaxify.data.template.register||config.hasOwnProperty("openDraftsOnPageLoad")&&!config.openDraftsOnPageLoad)return;const e=i.getList("available"),t=i.getList("open");e.length&&e.forEach(function(r){if(!r||t.includes(r))return;const o=i.get(r);if(!o||!o.text&&!o.title){i.removeFromDraftList("available",r),i.removeFromDraftList("open",r);return}m(r,o)})};function m(e,t){const o=e.split(":")[1];parseInt(app.user.uid,10)===parseInt(o,10)&&Promise.all([a.e(23662),a.e(65285),a.e(54516),a.e(99166),a.e(47061),a.e(11484)]).then(function(){var s=[a(71431)];(function(l){t.action==="topics.post"?l.newTopic({save_id:t.save_id,cid:t.cid,handle:app.user&&app.user.uid?void 0:utils.escapeHTML(t.handle),title:utils.escapeHTML(t.title),body:t.text,tags:String(t.tags||"").split(",")}):t.action==="posts.reply"?h.get("/topics/"+t.tid,{},function(x,S){if(x)return d.error(x);l.newReply({save_id:t.save_id,tid:t.tid,toPid:t.toPid,title:S.title,body:t.text})}):t.action==="posts.edit"&&l.editPost({save_id:t.save_id,pid:t.pid,title:t.title?utils.escapeHTML(t.title):void 0,body:t.text})}).apply(null,s)}).catch(a.oe)}function g(e){var t;try{t=window[e];var r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(o){return o instanceof DOMException&&(o.code===22||o.code===1014||o.name==="QuotaExceededError"||o.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&t.length!==0}}return i}.apply(w,p),v!==void 0&&(y.exports=v)},91943:(y,w,a)=>{"use strict";var p,v;p=[a(89596),a(99594),a(36159),a(51916)],v=function(h,d,i,c){var b={},u={picture:function(){var t=this;t.find("#files").attr("accept","image/*").click()},upload:function(){var t=this;t.find("#files").attr("accept","").click()},thumbs:function(){b.exitFullscreen();var t=this;Promise.all([a.e(54516),a.e(99166),a.e(47061),a.e(29567)]).then(function(){var r=[a(71431)];(function(o){const s=t.get(0).getAttribute("data-uuid"),l=o.posts[s];(l.action==="topics.post"||l.action==="posts.edit"&&l.isMain)&&i.modal.open({id:s,pid:l.pid}).then(()=>{t.trigger("thumb.uploaded"),o.updateThumbCount(s,t)})}).apply(null,r)}).catch(a.oe)},tags:function(){var t=this;t.find(".tags-container").toggleClass("hidden")},zen:function(){var t=this;$(window).one("resize",function(){function r(){c.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),d.reposition(t),$(window).off("resize",r))}c.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),t.find(".write").focus(),$(window).on("resize",r),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",c.exit))}),c.toggle(t.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:t})}},m=[];b.exitFullscreen=function(){c.isEnabled&&c.isFullscreen&&c.exit()},b.addComposerButtons=function(){const t=$(".formatting-bar"),r=t.find(".formatting-group #fileForm");m.forEach(s=>{let l="";Array.isArray(s.dropdownItems)&&s.dropdownItems.length?l=e(s):l=`
					<li title="${s.title||""}">
						<button data-format="${s.name}" class="btn btn-sm btn-link text-reset position-relative" aria-label="${s.title||""}">
							<i class="${s.iconClass}"></i>
							${g(s)}
						</button>
					</li>
				`,r.before(l)}),t.find(".formatting-group>li").tooltip({container:"#content",animation:!1,trigger:"manual"}).on("mouseenter",function(s){const l=$(s.target);l.hasClass("dropdown-menu")||!!l.parents(".dropdown-menu").length||$(this).tooltip("show")}).on("click mouseleave",function(){$(this).tooltip("hide")})};function g(t){let r="";return t.badge&&(r='<span class="px-1 position-absolute top-0 start-100 translate-middle badge rounded text-bg-info"></span>'),r}function e(t){const r=t.dropdownItems.map(function(o){return`
				<li>
					<a href="#" data-format="${o.name}" class="dropdown-item rounded-1 position-relative" role="menuitem">
						<i class="${o.iconClass} text-secondary"></i> ${o.text}
						${g(o)}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1" title="${t.title}">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="${t.title}">
					<i class="${t.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1" role="menu">
				${r}
				</ul>
			</li>
		`}return b.addButton=function(t,r,o,s){s=s||t.replace("fa fa-",""),u[s]=r,m.push({name:s,iconClass:t,title:o})},b.addDropdown=function(t){m.push({iconClass:t.iconClass,title:t.title,dropdownItems:t.dropdownItems}),t.dropdownItems.forEach(r=>{r.name&&r.onClick&&(u[r.name]=r.onClick)})},b.getDispatchTable=function(){return u},b.addButtonDispatch=function(t,r){u[t]=r},b.addHandler=function(t){t.on("click",".formatting-bar [data-format]",function(r){var o=$(this).attr("data-format"),s=$(this).parents('[component="composer"]').find("textarea")[0];u.hasOwnProperty(o)&&(u[o].call(t,s,s.selectionStart,s.selectionEnd,r),h.render(t))})},b}.apply(w,p),v!==void 0&&(y.exports=v)},62590:(y,w,a)=>{"use strict";var p,v;p=[a(91749)],v=function(h){var d={};return d.render=function(i,c){if(c=c||function(){},!i.find(".preview-container").is(":visible"))return c();var b=i.find("textarea");socket.emit("plugins.composer.renderPreview",b.val(),function(u,m){u||(m=$("<div>"+m+"</div>"),m.find("img:not(.not-responsive)").addClass("img-fluid"),i.find(".preview").html(m),h.fire("action:composer.preview",{postContainer:i,preview:m}),c())})},d.matchScroll=function(i){if(i.find(".preview-container").is(":visible")){var c=i.find("textarea"),b=i.find(".preview");if(c.length&&b.length){var u=c[0].scrollHeight-c.height();if(u===0)return;var m=c.scrollTop()/u;b.scrollTop(Math.max(b[0].scrollHeight-b.height(),0)*m)}}},d.handleToggler=function(i){const c=i.get(0);d.env=utils.findBootstrapEnvironment();const b=["xs","sm"].includes(d.env),u=c.querySelector('.formatting-bar [data-action="preview"]'),m=u.querySelector(".show-text"),g=u.querySelector(".hide-text"),e=localStorage.getItem("composer:previewToggled"),t=config["composer-default"].hidePreviewOnOpen==="on";let r=!b&&(e===null&&!t||e==="true");const o=c.querySelector(".preview-container"),s=c.querySelector(".write-container");if(!u)return;function l(x){b?(o.classList.toggle("hide",!1),s.classList.toggle("maximized",!1),o.classList.toggle("d-none",!x),o.classList.toggle("d-flex",x),o.classList.toggle("w-100",x),s.classList.toggle("d-flex",!x),s.classList.toggle("d-none",x),s.classList.toggle("w-100",!x)):(o.classList.toggle("hide",!x),s.classList.toggle("w-50",x),s.classList.toggle("w-100",!x),localStorage.setItem("composer:previewToggled",x)),m.classList.toggle("hide",x),g.classList.toggle("hide",!x),x&&d.render(i),d.matchScroll(i)}d.toggle=l,u.addEventListener("click",x=>{x.button===0&&(r=!r,l(r))}),l(r)},d}.apply(w,p),v!==void 0&&(y.exports=v)},57904:(y,w,a)=>{"use strict";var p,v;p=[a(14063)],v=function(h){var d={},i=0,c=.3,b=.05,u=768,m=$("body"),g=$(window),e=$('[component="navbar"]');const t=document.getElementById("content");var r=e[0];function o(){return localStorage.getItem("composer:resizeRatio")||.5}function s(E){localStorage.setItem("composer:resizeRatio",Math.min(E,1))}function l(){var E;r?E=r.getBoundingClientRect():E={bottom:0};var D=Math.max(E.bottom,0),I={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return I.width=I.right,I.height=I.bottom,I.boundedTop=D,I.boundedHeight=I.bottom-D,I}function x(E,D){var I=l(),k=E[0],O=window.getComputedStyle(k),W=parseInt(O.getPropertyValue("min-height"),10),z=Math.max(W/window.innerHeight,c);if(I.width>=u){const H=(I.height-I.boundedHeight)/I.height;D=Math.min(Math.max(D,z+H),1);var N=D*I.boundedHeight/I.height;k.style.top=((1-N)*100).toString()+"%";var L=k.getBoundingClientRect();t.style.paddingBottom=(L.bottom-L.top).toString()+"px"}else k.style.top=0,t.style.paddingBottom=0;E.ratio=D,h.updateActive(E.attr("data-uuid"))}var S=x,F=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return F&&(S=function(E,D){F(function(){x(E,D),setTimeout(function(){g.trigger("action:composer.resize"),E.trigger("action:composer.resize")},0)})}),d.reposition=function(E){var D=o();D>=1-b&&(D=1,E.addClass("maximized")),S(E,D)},d.maximize=function(E,D){D?S(E,1):d.reposition(E)},d.handleResize=function(E){var D=0,I=0,k=0,O=E.find(".resizer"),W=O[0];function z(P){var B=W.getBoundingClientRect(),T=(B.top+B.bottom)/2;D=(T-P.clientY)/2,I=P.clientY,g.on("mousemove",N),g.on("mouseup",L),m.on("touchmove",H)}function N(P){var B=P.clientY-D,T=l(),n=(T.height-B)/T.boundedHeight;S(E,n)}function L(P){P.preventDefault(),k=P.clientY,E.find("textarea").focus(),g.off("mousemove",N),g.off("mouseup",L),m.off("touchmove",H);var B=k-D,T=l(),n=(T.height-B)/T.boundedHeight;k-I===0&&E.hasClass("maximized")?(E.removeClass("maximized"),n=!i||i>=1-b?.5:i,S(E,n)):k-I===0||n>=1-b?(S(E,1),E.addClass("maximized"),i=n):E.removeClass("maximized"),s(n)}function H(P){P.preventDefault(),N(P.touches[0])}O.on("mousedown",function(P){P.button===0&&(P.preventDefault(),z(P))}).on("touchstart",function(P){P.preventDefault(),z(P.touches[0])}).on("touchend",L)},d}.apply(w,p),v!==void 0&&(y.exports=v)},51916:y=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var w=typeof window<"u"&&typeof window.document<"u"?window.document:{},a=y.exports,p=function(){for(var d,i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],c=0,b=i.length,u={};c<b;c++)if(d=i[c],d&&d[1]in w){for(c=0;c<d.length;c++)u[i[0][c]]=d[c];return u}return!1}(),v={change:p.fullscreenchange,error:p.fullscreenerror},h={request:function(d,i){return new Promise(function(c,b){var u=function(){this.off("change",u),c()}.bind(this);this.on("change",u),d=d||w.documentElement;var m=d[p.requestFullscreen](i);m instanceof Promise&&m.then(u).catch(b)}.bind(this))},exit:function(){return new Promise(function(d,i){if(!this.isFullscreen){d();return}var c=function(){this.off("change",c),d()}.bind(this);this.on("change",c);var b=w[p.exitFullscreen]();b instanceof Promise&&b.then(c).catch(i)}.bind(this))},toggle:function(d,i){return this.isFullscreen?this.exit():this.request(d,i)},onchange:function(d){this.on("change",d)},onerror:function(d){this.on("error",d)},on:function(d,i){var c=v[d];c&&w.addEventListener(c,i,!1)},off:function(d,i){var c=v[d];c&&w.removeEventListener(c,i,!1)},raw:p};if(!p){a?y.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(h,{isFullscreen:{get:function(){return!!w[p.fullscreenElement]}},element:{enumerable:!0,get:function(){return w[p.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!w[p.fullscreenEnabled]}}}),a?y.exports=h:window.screenfull=h})()}}]);
